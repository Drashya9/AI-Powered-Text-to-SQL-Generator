sql_prompt,sql_context,gold_sql,generated_sql,exact_match,execution_match
Which menu items have a high sodium content and are also bestsellers?,"CREATE TABLE MenuItems (id INT, item VARCHAR(30), sodium INT, popularity INT); INSERT INTO MenuItems (id, item, sodium, popularity) VALUES (1, 'French Fries', 500, 100), (2, 'Grilled Chicken', 300, 50);","SELECT item, sodium FROM MenuItems WHERE popularity > 70 ORDER BY sodium DESC;",SELECT item FROM MenuItems WHERE sodium > 300 AND popularity > 50;,False,False
What is the earliest inspection date for each vessel type?,"CREATE TABLE vessels (id INT, type VARCHAR(255)); CREATE TABLE inspections (id INT, vessel_id INT, inspection_date DATE); INSERT INTO vessels VALUES (1, 'Tanker'), (2, 'Cargo Ship'); INSERT INTO inspections VALUES (1, 1, '2021-01-01'), (2, 1, '2020-01-01'), (3, 2, '2021-01-03');","SELECT v.type, MIN(i.inspection_date) as earliest_date FROM vessels v JOIN inspections i ON v.id = i.vessel_id GROUP BY v.type;","SELECT v.type, MIN(i.inspection_date) FROM vessels v JOIN inspections i ON v.id = i.vessel_id GROUP BY v.type",False,False
What is the average height of female basketball players in the players table?,"CREATE TABLE players (player_id INT, name VARCHAR(50), position VARCHAR(50), height FLOAT, weight INT, team_id INT, league VARCHAR(50)); INSERT INTO players (player_id, name, position, height, weight, team_id, league) VALUES (1, 'Alice', 'Guard', 1.75, 70, 101, 'NBA');",SELECT AVG(height) FROM players WHERE position = 'Guard' AND league = 'NBA' AND gender = 'Female';,SELECT AVG(height) FROM players WHERE position = 'Guard' AND name LIKE '%Alice%';,False,False
What is the average dissolved oxygen level for each location in the past 3 years?,"CREATE TABLE dissolved_oxygen_readings (location VARCHAR(255), year INT, dissolved_oxygen FLOAT); INSERT INTO dissolved_oxygen_readings (location, year, dissolved_oxygen) VALUES ('Location A', 2018, 6.2), ('Location A', 2019, 6.3), ('Location A', 2020, 6.5), ('Location B', 2018, 5.9), ('Location B', 2019, 6.0), ('Location B', 2020, 6.2);","SELECT location, AVG(dissolved_oxygen) as avg_dissolved_oxygen FROM dissolved_oxygen_readings WHERE year >= (SELECT MAX(year) - 3 FROM dissolved_oxygen_readings) GROUP BY location;","SELECT location, AVG(dissolved_oxygen) AS avg_dissolved_oxygen
FROM dissolved_oxygen_readings
WHERE year >= 2018
GROUP BY location;",False,False
What is the total revenue for restaurants with a seating capacity of over 100?,"CREATE TABLE Restaurants (restaurant_id INT, name VARCHAR(255), seating_capacity INT, revenue DECIMAL(10,2)); INSERT INTO Restaurants (restaurant_id, name, seating_capacity, revenue) VALUES (1, 'Restaurant A', 150, 5000.00), (2, 'Restaurant B', 50, 6000.00), (3, 'Restaurant C', 200, 4000.00);",SELECT SUM(revenue) FROM Restaurants WHERE seating_capacity > 100;,SELECT SUM(revenue) FROM Restaurants WHERE seating_capacity > 100;,True,True
How many clinical trials were completed for drugs that were approved after 2017?,"CREATE TABLE clinical_trials (id INT PRIMARY KEY, drug_id INT, phase VARCHAR(50), completion_date DATE); CREATE TABLE drugs (id INT PRIMARY KEY, name VARCHAR(255), manufacturer VARCHAR(255), approval_date DATE);",SELECT COUNT(ct.id) as total_completed_trials FROM clinical_trials ct JOIN drugs d ON ct.drug_id = d.id WHERE d.approval_date > '2017-01-01';,SELECT COUNT(*) FROM clinical_trials ct JOIN drugs d ON ct.drug_id = d.id WHERE d.approval_date > '2017-12-31',False,False
What is the total landfill capacity (in cubic meters) for the 'eastern' region in 2022?,"CREATE TABLE landfill_capacity(region VARCHAR(10), year INT, capacity INT); INSERT INTO landfill_capacity VALUES('eastern', 2021, 500000), ('eastern', 2022, 550000), ('western', 2021, 600000), ('western', 2022, 650000);",SELECT capacity FROM landfill_capacity WHERE region = 'eastern' AND year = 2022;,SELECT capacity FROM landfill_capacity WHERE region = 'eastern' AND year = 2022;,True,True
What is the average dissolved oxygen level for each region?,"CREATE TABLE region (region_id INT, region_name TEXT); INSERT INTO region (region_id, region_name) VALUES (1, 'North Atlantic'), (2, 'South Atlantic'), (3, 'Indian Ocean'); CREATE TABLE measurement (measurement_id INT, region_id INT, dissolved_oxygen FLOAT); INSERT INTO measurement (measurement_id, region_id, dissolved_oxygen) VALUES (1, 1, 6.5), (2, 1, 6.8), (3, 2, 7.1), (4, 2, 6.9), (5, 3, 7.3), (6, 3, 7.2);","SELECT region_id, AVG(dissolved_oxygen) FROM measurement GROUP BY region_id;","SELECT r.region_name, AVG(m.dissolved_oxygen) AS avg_dissolved_oxygen
FROM region r
JOIN measurement m ON r.region_id = m.region_id
GROUP BY r.region_name;",False,False
Find the total number of workouts and unique members who have participated in outdoor workouts in the last year.,"CREATE TABLE workouts (id INT, member_id INT, workout_type VARCHAR(50), duration INT, date DATE); INSERT INTO workouts (id, member_id, workout_type, duration, date) VALUES (1, 1, 'Cycling', 60, '2022-03-10'), (2, 3, 'Yoga', 45, '2022-03-15'), (3, 2, 'Running', 30, '2022-02-20'), (4, 4, 'Hiking', 120, '2022-04-01');","SELECT COUNT(*) AS total_workouts, COUNT(DISTINCT member_id) AS unique_members FROM workouts w WHERE w.workout_type LIKE '%Outdoor%' AND w.date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);","SELECT COUNT(DISTINCT member_id) AS unique_members, COUNT(*) AS total_workouts FROM workouts WHERE workout_type IN ('Cycling', 'Running', 'Hiking') AND date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);",False,False
Display the names and positions of all engineers in the Avionics department.,"CREATE TABLE Employees (EmployeeID INT, FirstName VARCHAR(50), LastName VARCHAR(50), Position VARCHAR(50), Department VARCHAR(50)); INSERT INTO Employees (EmployeeID, FirstName, LastName, Position, Department) VALUES (1, 'Jane', 'Doe', 'Avionics Engineer', 'Avionics');","SELECT EmployeeID, FirstName, LastName, (CASE WHEN Position = 'Avionics Engineer' THEN 'Senior Avionics Engineer' ELSE Position END) AS NewPosition, Department FROM Employees WHERE Department = 'Avionics';","SELECT FirstName, LastName, Position FROM Employees WHERE Department = 'Avionics' AND Position LIKE '%Engineer%';",False,False
What is the average cost of meat-based dishes?,"CREATE TABLE menu_items (item VARCHAR(50), type VARCHAR(15), cost DECIMAL(10,2)); INSERT INTO menu_items (item, type, cost) VALUES ('Beef Burger', 'Meat', 10.00), ('Chicken Sandwich', 'Meat', 8.00); CREATE VIEW meat_menu_items AS SELECT item, cost FROM menu_items WHERE type = 'Meat';",SELECT AVG(cost) FROM meat_menu_items;,SELECT AVG(cost) FROM meat_menu_items;,True,True
Find the number of marine protected areas established per year worldwide.,"CREATE TABLE marine_protected_areas (area_name VARCHAR(255), establishment_year INT, location VARCHAR(255)); INSERT INTO marine_protected_areas (area_name, establishment_year, location) VALUES ('Coral Pink Sand Dunes State Park', 1963, 'USA'), ('Papahānaumokuākea Marine National Monument', 2006, 'USA'), ('Riserva Marina di Portofino', 1999, 'Italy');","SELECT establishment_year, COUNT(*) FROM marine_protected_areas GROUP BY establishment_year;","SELECT establishment_year, COUNT(*) FROM marine_protected_areas GROUP BY establishment_year;",True,True
Show all buildings and their certifications from 'green_buildings',"CREATE TABLE green_buildings (id INT PRIMARY KEY, name VARCHAR(50), location VARCHAR(50), size INT, certification VARCHAR(50));","SELECT name, certification FROM green_buildings;","SELECT name, certification FROM green_buildings;",True,True
Identify brands that have increased their product count by more than 50% since last year.,"CREATE TABLE brands(brand_id INT, brand_name TEXT, products_last_year INT, products_this_year INT); INSERT INTO brands(brand_id, brand_name, products_last_year, products_this_year) VALUES (1, 'BrandA', 200, 300), (2, 'BrandB', 500, 700), (3, 'BrandC', 1000, 1200), (4, 'BrandD', 800, 700), (5, 'BrandE', 900, 1000);","SELECT brand_id, brand_name, ((products_this_year - products_last_year) * 100.0 / products_last_year) as growth_percentage FROM brands WHERE (products_this_year - products_last_year) > 0.5 * products_last_year ORDER BY growth_percentage DESC;",SELECT brand_name FROM brands WHERE CAST(products_this_year AS REAL) / products_last_year > 1.5;,False,False
What was the average ticket price for each age group?,"CREATE TABLE tickets (ticket_id INT, age_group VARCHAR(10), price DECIMAL(5,2)); INSERT INTO tickets (ticket_id, age_group, price) VALUES (1, 'Adult', 20.00), (2, 'Child', 15.00), (3, 'Senior', 10.00);","SELECT age_group, AVG(price) as avg_price FROM tickets GROUP BY age_group;","SELECT age_group, AVG(price) AS average_price FROM tickets GROUP BY age_group;",False,False
What is the average life expectancy in each country?,"CREATE TABLE countries (country_id INT, country_name VARCHAR(255)); INSERT INTO countries VALUES (1, 'CountryA'), (2, 'CountryB'); CREATE TABLE life_expectancy (country_id INT, life_expectancy DECIMAL(5,2), year INT); INSERT INTO life_expectancy VALUES (1, 75.5, 2020), (2, 80.3, 2020);","SELECT countries.country_name, AVG(life_expectancy) AS avg_life_expectancy FROM countries INNER JOIN life_expectancy ON countries.country_id = life_expectancy.country_id GROUP BY countries.country_name;","SELECT c.country_name, AVG(le.life_expectancy) AS average_life_expectancy
FROM countries c
JOIN life_expectancy le ON c.country_id = le.country_id
GROUP BY c.country_name;",False,False
Which technology for social good projects have the highest budgets?,"CREATE TABLE social_good_projects (id INT, project_name TEXT, budget INT); INSERT INTO social_good_projects (id, project_name, budget) VALUES (1, 'Smart Energy Grids', 900000), (2, 'AI for Disaster Response', 700000), (3, 'Accessible Technology Initiative', 800000);","SELECT project_name, budget FROM social_good_projects ORDER BY budget DESC LIMIT 2;",SELECT project_name FROM social_good_projects ORDER BY budget DESC LIMIT 1;,False,False
Get the percentage of male and female readers who prefer technology news in the UK.,"CREATE TABLE readers (id INT, age INT, gender VARCHAR(10), country VARCHAR(50), news_preference VARCHAR(50)); INSERT INTO readers (id, age, gender, country, news_preference) VALUES (1, 35, 'Male', 'UK', 'Technology'), (2, 45, 'Female', 'UK', 'Technology');","SELECT gender, PERCENTAGE := (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM readers WHERE country = 'UK' AND news_preference = 'Technology')) percentage FROM readers WHERE country = 'UK' AND news_preference = 'Technology' GROUP BY gender;","SELECT gender, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () AS percentage FROM readers WHERE country = 'UK' AND news_preference = 'Technology' GROUP BY gender;",False,False
"List defense projects that started in 2019 and their associated risks, if any.","CREATE TABLE DefenseProjects (id INT, project_name VARCHAR(50), start_date DATE, risk_level INT); INSERT INTO DefenseProjects (id, project_name, start_date, risk_level) VALUES (1, 'Project G', '2019-01-01', 3), (2, 'Project H', '2018-06-15', 5), (3, 'Project I', '2019-12-31', NULL);","SELECT project_name, risk_level FROM DefenseProjects WHERE start_date >= '2019-01-01' AND start_date <= '2019-12-31' AND risk_level IS NOT NULL;","SELECT project_name, risk_level FROM DefenseProjects WHERE strftime('%Y', start_date) = '2019';",False,False
Count the number of unique users who engaged with virtual tours in 'January'?,"CREATE TABLE user_activity (user_id INT, activity_date DATE); INSERT INTO user_activity (user_id, activity_date) VALUES (1, '2023-01-01'), (2, '2023-01-05'), (3, '2023-01-07'), (4, '2023-01-10'), (5, '2023-01-12');",SELECT COUNT(DISTINCT user_id) FROM user_activity WHERE EXTRACT(MONTH FROM activity_date) = 1;,SELECT COUNT(DISTINCT user_id) FROM user_activity WHERE activity_date LIKE '2023-01%';,False,False
What are the names of all green building projects in the city of Toronto?,"CREATE TABLE green_building_projects (project_id INT, project_name VARCHAR(255), city VARCHAR(255), country VARCHAR(255)); INSERT INTO green_building_projects (project_id, project_name, city, country) VALUES (1, 'Toronto Green Tower', 'Toronto', 'CA'); INSERT INTO green_building_projects (project_id, project_name, city, country) VALUES (2, 'Canadian Eco-Skyscraper', 'Toronto', 'CA');",SELECT project_name FROM green_building_projects WHERE city = 'Toronto';,SELECT project_name FROM green_building_projects WHERE city = 'Toronto';,True,True
Update the registration date of voter with ID '12345' to '2022-01-01'.,"CREATE TABLE voting_data (voter_id INT, name VARCHAR(100), age INT, state VARCHAR(50), registration_date DATE);",UPDATE voting_data SET registration_date = '2022-01-01' WHERE voter_id = 12345;,UPDATE voting_data SET registration_date = '2022-01-01' WHERE voter_id = '12345';,False,False
"Which sustainable practices were used in the 'Structural Engineering' department that cost over $10,000?","CREATE TABLE SustainablePractices (PracticeID INT, PracticeName VARCHAR(50), Description VARCHAR(255), Department VARCHAR(50), Cost DECIMAL(10,2)); INSERT INTO SustainablePractices (PracticeID, PracticeName, Description, Department, Cost) VALUES (5, 'Green Roof', 'Installing a green roof to reduce energy consumption and improve air quality.', 'Structural Engineering', 12000.00), (6, 'Rainwater Harvesting', 'Collecting and storing rainwater for irrigation and non-potable uses.', 'Structural Engineering', 8000.00);",SELECT SustainablePractices.PracticeName FROM SustainablePractices WHERE SustainablePractices.Department = 'Structural Engineering' AND SustainablePractices.Cost > 10000.00;,SELECT PracticeName FROM SustainablePractices WHERE Department = 'Structural Engineering' AND Cost > 10000;,False,False
What is the total population of cities founded before the year 1800?,"CREATE TABLE City (id INT, name VARCHAR(50), population INT, founded DATE); INSERT INTO City (id, name, population, founded) VALUES (1, 'New York', 8500000, '1624-09-17'); INSERT INTO City (id, name, population, founded) VALUES (2, 'Los Angeles', 4000000, '1781-09-04');",SELECT SUM(population) FROM City WHERE YEAR(founded) < 1800;,SELECT SUM(population) FROM City WHERE founded < '1800-01-01';,False,False
"What is the percentage of students in the ""Hillside"" school district who did not participate in lifelong learning programs last year?","CREATE TABLE students (student_id INT, district VARCHAR(20), participated_in_llp BOOLEAN, year INT); INSERT INTO students (student_id, district, participated_in_llp, year) VALUES (1, 'Hillside', TRUE, 2021), (2, 'Hillside', FALSE, 2021), (3, 'Townside', TRUE, 2021);",SELECT (COUNT(*) FILTER (WHERE NOT participated_in_llp)) * 100.0 / COUNT(*) FROM students WHERE district = 'Hillside' AND year = 2021;,SELECT CAST(SUM(CASE WHEN participated_in_llp = FALSE THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(*) FROM students WHERE district = 'Hillside' AND year = 2021;,False,False
How many marine species are found in the Southern Ocean?,"CREATE TABLE marine_species (name VARCHAR(50), common_name VARCHAR(50), location VARCHAR(50));",SELECT COUNT(*) FROM marine_species WHERE location = 'Southern Ocean';,SELECT COUNT(*) FROM marine_species WHERE location = 'Southern Ocean';,True,True
Delete artists who have less than 2 artworks in the 'Artworks' table,"CREATE TABLE Artworks (Artist VARCHAR(50), Artwork VARCHAR(50), Year INT); INSERT INTO Artworks",DELETE FROM Artworks WHERE Artist IN (SELECT Artist FROM Artworks GROUP BY Artist HAVING COUNT(Artwork) < 2),DELETE FROM Artworks WHERE Artist IN (SELECT Artist FROM Artworks GROUP BY Artist HAVING COUNT(*) < 2);,False,False
Delete a program's outcome data,"CREATE TABLE Program_Outcomes (id INT, program_id INT, outcome_type VARCHAR, value INT, outcome_date DATE); INSERT INTO Program_Outcomes (id, program_id, outcome_type, value, outcome_date) VALUES (1, 1001, 'participants', 50, '2021-01-01'), (2, 1002, 'hours_donated', 1000, '2021-01-01');",DELETE FROM Program_Outcomes WHERE program_id = 1002;,DELETE FROM Program_Outcomes WHERE id=1;,False,False
Create a table named 'ocean_species',"CREATE TABLE ocean_species(id INT PRIMARY KEY, species VARCHAR(100), population INT, region VARCHAR(50));","CREATE TABLE ocean_species (id INT PRIMARY KEY, species VARCHAR(100), population INT, region VARCHAR(50));","CREATE TABLE ocean_species(id INT PRIMARY KEY, species VARCHAR(100), population INT, region VARCHAR(50));",False,False
What's the total investment in all sectors?,"CREATE TABLE investments (id INT, sector VARCHAR(20), amount FLOAT); INSERT INTO investments (id, sector, amount) VALUES (1, 'Education', 150000.00), (2, 'Healthcare', 120000.00), (3, 'Renewable Energy', 200000.00);",SELECT SUM(amount) FROM investments;,SELECT SUM(amount) FROM investments;,True,True
Which autonomous vehicles have the highest safety ratings in the 'auto_show' table?,"CREATE TABLE auto_show (id INT, vehicle_name VARCHAR(50), safety_rating INT);","SELECT vehicle_name, safety_rating FROM (SELECT vehicle_name, safety_rating, RANK() OVER (ORDER BY safety_rating DESC) as safety_rank FROM auto_show WHERE vehicle_name LIKE '%Autonomous%') AS auton_ranks WHERE safety_rank = 1;",SELECT vehicle_name FROM auto_show ORDER BY safety_rating DESC LIMIT 1;,False,False
Who funded the excavation of 'Palenque' and what was the date?,"CREATE TABLE Funding (SiteID INT, FundingAgency TEXT, FundingDate DATE); INSERT INTO Funding (SiteID, FundingAgency, FundingDate) VALUES (5, 'Mexican Government', '2005-02-01'), (6, 'Spanish Government', '2010-03-01'), (7, 'American Government', '2015-04-01');","SELECT FundingAgency, FundingDate FROM Funding f JOIN ExcavationSites e ON f.SiteID = e.SiteID WHERE e.SiteName = 'Palenque';","SELECT FundingAgency, FundingDate FROM Funding WHERE SiteID = (SELECT id FROM excavations WHERE location = 'Palenque')",False,False
"What is the total quantity of 'Eco-Friendly Denim Jackets' sold per store, ranked by the highest sales?","CREATE TABLE Stores (store_id INT, store_name VARCHAR(50)); INSERT INTO Stores VALUES (1, 'Store A'), (2, 'Store B'), (3, 'Store C'); CREATE TABLE Sales (sale_id INT, product_name VARCHAR(50), store_id INT, quantity_sold INT); INSERT INTO Sales VALUES (1, 'Eco-Friendly Denim Jacket', 1, 30), (2, 'Eco-Friendly Denim Jacket', 2, 45), (3, 'Eco-Friendly Denim Jacket', 3, 60);","SELECT store_id, store_name, SUM(quantity_sold) as total_sold FROM Sales JOIN Stores ON Sales.store_id = Stores.store_id WHERE product_name = 'Eco-Friendly Denim Jacket' GROUP BY store_id, store_name ORDER BY total_sold DESC;","SELECT s.store_id, st.store_name, SUM(s.quantity_sold) AS total_quantity_sold
FROM Sales s
JOIN Stores st ON s.store_id = st.store_id
WHERE s.product_name = 'Eco-Friendly Denim Jacket'
GROUP BY s.store_id, st.store_name
ORDER BY total_quantity_sold DESC;",False,False
"What is the maximum number of green buildings in each state in the US, constructed before 2015?","CREATE TABLE green_buildings_us (id INT, state VARCHAR(20), construction_year INT, type VARCHAR(20)); INSERT INTO green_buildings_us (id, state, construction_year, type) VALUES (1, 'California', 2014, 'residential'), (2, 'California', 2012, 'commercial'), (3, 'Oregon', 2016, 'residential'), (4, 'Washington', 2013, 'residential');","SELECT state, MAX(cnt) FROM (SELECT state, COUNT(*) AS cnt FROM green_buildings_us WHERE construction_year < 2015 GROUP BY state) AS subquery;","SELECT state, MAX(COUNT(*)) FROM green_buildings_us WHERE construction_year < 2015 GROUP BY state;",False,False
How many songs are in the 'Rock' genre that were released between 1990 and 2000?,"CREATE TABLE genres (genre_id INT, genre VARCHAR(50)); INSERT INTO genres (genre_id, genre) VALUES (1, 'Pop'), (2, 'Rock'), (3, 'Hip Hop'), (4, 'Jazz'); CREATE TABLE songs (song_id INT, song_name VARCHAR(100), release_year INT, genre_id INT); INSERT INTO songs (song_id, song_name, release_year, genre_id) VALUES (1, 'Shape of You', 2017, 1), (2, 'Thinking Out Loud', 2014, 1), (3, 'Bohemian Rhapsody', 1975, 2), (4, 'Smells Like Teen Spirit', 1991, 2), (5, 'No Woman No Cry', 1974, 4), (6, 'November Rain', 1991, 2);",SELECT COUNT(*) FROM songs WHERE genre_id = (SELECT genre_id FROM genres WHERE genre = 'Rock') AND release_year BETWEEN 1990 AND 2000;,SELECT COUNT(*) FROM songs WHERE genre_id = (SELECT genre_id FROM genres WHERE genre = 'Rock') AND release_year BETWEEN 1990 AND 2000;,True,True
What is the average number of employees for gold mines located in Canada?,"CREATE TABLE gold_mines (id INT, name VARCHAR(50), location VARCHAR(50), size INT, num_employees INT, co2_emissions INT); INSERT INTO gold_mines VALUES (1, 'Gold Mine 1', 'Canada', 450, 320, 22000); INSERT INTO gold_mines VALUES (2, 'Gold Mine 2', 'Canada', 600, 450, 28000); INSERT INTO gold_mines VALUES (3, 'Gold Mine 3', 'Mexico', 200, 180, 16000);",SELECT AVG(num_employees) FROM gold_mines WHERE location = 'Canada';,SELECT AVG(num_employees) FROM gold_mines WHERE location = 'Canada';,True,True
"How many athletes have participated in wellbeing programs in each sport in the last year, and which sport had the most participants?","CREATE TABLE wellbeing_programs (athlete_id INT, sport VARCHAR(50), program_date DATE); INSERT INTO wellbeing_programs (athlete_id, sport, program_date) VALUES (1, 'Soccer', '2022-01-01'), (2, 'Basketball', '2022-01-02'), (3, 'Football', '2022-01-03'), (4, 'Soccer', '2022-01-04'), (5, 'Baseball', '2022-01-05');","SELECT sport, COUNT(DISTINCT athlete_id) AS participants FROM wellbeing_programs WHERE program_date >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY sport ORDER BY participants DESC;","WITH SportCounts AS (
  SELECT sport, COUNT(DISTINCT athlete_id) AS athlete_count
  FROM wellbeing_programs
  WHERE program_date >= DATE('now', '-1 year')
  GROUP BY sport
)
SELECT sport, athlete_count
FROM SportCounts
UNION ALL
SELECT (SELECT sport FROM SportCounts ORDER BY athlete_count DESC LIMIT 1) , (SELECT MAX(athlete_count) FROM SportCounts);",False,False
List all the donors who have donated to more than one organization?,"CREATE TABLE donor (don_id INT, don_name TEXT); CREATE TABLE donation (don_id INT, org_id INT); INSERT INTO donor (don_id, don_name) VALUES (1, 'Richard Roe'), (2, 'Susan Smith'), (3, 'Mark Miller'); INSERT INTO donation (don_id, org_id) VALUES (1, 1), (1, 2), (2, 2), (3, 3), (3, 4);","SELECT don_id, don_name FROM donor WHERE don_id IN (SELECT don_id FROM (SELECT don_id, COUNT(DISTINCT org_id) as num_orgs FROM donation GROUP BY don_id) WHERE num_orgs > 1);",SELECT don_name FROM donor WHERE don_id IN (SELECT don_id FROM donation GROUP BY don_id HAVING COUNT(DISTINCT org_id) > 1),False,False
What is the average age of healthcare workers by region?,"CREATE TABLE healthcare_workers (id INT, name VARCHAR(50), age INT, region VARCHAR(50)); INSERT INTO healthcare_workers (id, name, age, region) VALUES (1, 'John Doe', 35, 'Northeast');","SELECT region, AVG(age) as avg_age FROM healthcare_workers GROUP BY region;","SELECT region, AVG(age) FROM healthcare_workers GROUP BY region;",False,False
What is the number of vaccinations administered by gender?,"CREATE TABLE vaccinations(id INT, patient_id INT, gender TEXT, date DATE);","SELECT gender, COUNT(*) FROM vaccinations GROUP BY gender;","SELECT gender, COUNT(*) FROM vaccinations GROUP BY gender;",True,True
What is the total quantity of each product sold in the last week and the total revenue generated from those sales?,"CREATE TABLE sales (sale_id INT, product_id INT, quantity INT, sale_date DATE, revenue INT); INSERT INTO sales (sale_id, product_id, quantity, sale_date, revenue) VALUES (1, 1, 3, '2022-01-05', 15), (2, 2, 1, '2022-01-07', 10); CREATE TABLE product (product_id INT, product_name TEXT, region_id INT); INSERT INTO product (product_id, product_name, region_id) VALUES (1, 'Coca Cola', 1), (2, 'Pizza', 2);","SELECT p.product_name, SUM(s.quantity) as total_quantity, SUM(s.revenue) as total_revenue FROM sales s JOIN product p ON s.product_id = p.product_id WHERE s.sale_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 WEEK) GROUP BY p.product_name;","SELECT p.product_name, SUM(s.quantity) AS total_quantity, SUM(s.revenue) AS total_revenue
FROM sales s
JOIN product p ON s.product_id = p.product_id
WHERE s.sale_date >= DATE('now', '-7 days')
GROUP BY p.product_name;",False,False
"What is the number of climate adaptation projects in each region, and what is the percentage of the total for each region?","CREATE TABLE climate_projects (id INT, region TEXT, project_type TEXT); CREATE VIEW total_projects AS SELECT COUNT(*) as total_projects FROM climate_projects;","SELECT region, COUNT(*) as region_projects, (COUNT(*) / (SELECT total_projects FROM total_projects)) as percentage FROM climate_projects WHERE project_type = 'adaptation' GROUP BY region;","SELECT COUNT(*) AS num_adaptation_projects, region, (COUNT(*) * 100.0 / (SELECT total_projects FROM total_projects)) AS percentage FROM climate_projects WHERE project_type = 'adaptation' GROUP BY region;",False,False
"Determine the percentage of total sales for each garment, partitioned by category and ordered by percentage.","CREATE TABLE sales (garment VARCHAR(50), category VARCHAR(50), quantity INT, sale_date DATE); INSERT INTO sales (garment, category, quantity, sale_date) VALUES ('Shirt', 'Tops', 15, '2021-01-05'), ('Pants', 'Bottoms', 20, '2021-01-05'), ('Dress', 'Tops', 30, '2021-01-10');","SELECT garment, category, quantity, 100.0 * quantity / SUM(quantity) OVER (PARTITION BY category) as percentage FROM sales ORDER BY percentage DESC;","WITH CategoryTotals AS (
  SELECT
    category,
    SUM(quantity) AS total_quantity
  FROM sales
  GROUP BY
    category
), GarmentTotals AS (
  SELECT
    garment,
    category,
    SUM(quantity) AS garment_quantity
  FROM sales
  GROUP BY
    garment,
    category
)
SELECT
  garment,
  category,
  (
    garment_quantity / total_quantity
  ) * 100 AS percentage_of_total
FROM GarmentTotals
JOIN CategoryTotals
  ON GarmentTotals.category = CategoryTotals.category
ORDER BY
  percentage_of_total DESC;",False,False
What is the average potency of sativa strains sold in Washington state?,"CREATE TABLE strains (strain_id INT, strain_name TEXT, strain_type TEXT, state TEXT, potency DECIMAL); INSERT INTO strains (strain_id, strain_name, strain_type, state, potency) VALUES (1, 'Purple Haze', 'Sativa', 'Washington', 18);",SELECT AVG(potency) FROM strains WHERE strain_type = 'Sativa' AND state = 'Washington';,SELECT AVG(potency) FROM strains WHERE strain_type = 'Sativa' AND state = 'Washington';,True,True
What is the total length of all ocean floor mapping projects in the 'MappingLengths' table?,"CREATE TABLE MappingLengths (MappingID INT PRIMARY KEY, MappingName TEXT, MappingLength FLOAT);",SELECT SUM(MappingLength) FROM MappingLengths;,SELECT SUM(MappingLength) FROM MappingLengths;,True,True
Calculate the total production in the Southern region by oil and gas type,"CREATE TABLE production (well_id INT, type VARCHAR(10), region VARCHAR(50), quantity INT); INSERT INTO production (well_id, type, region, quantity) VALUES (1, 'Oil', 'Northern', 1000), (2, 'Gas', 'Southern', 2000), (3, 'Oil', 'Southern', 3000);","SELECT type, SUM(quantity) as total_production FROM production WHERE region = 'Southern' GROUP BY type;","SELECT SUM(quantity) FROM production WHERE region = 'Southern' AND type IN ('Oil', 'Gas');",False,False
Update the gender of all users who have not specified their gender to 'non-binary'.,"CREATE TABLE users (user_id INT, age INT, gender VARCHAR(50)); INSERT INTO users (user_id, age, gender) VALUES (1, 25, 'male'), (2, 35, NULL);",UPDATE users SET gender = 'non-binary' WHERE gender IS NULL;,UPDATE users SET gender = 'non-binary' WHERE gender IS NULL;,True,True
"What are the vehicle safety testing organizations that operate in the UK, France, and Germany?","CREATE TABLE SafetyOrgs (name VARCHAR(20), country VARCHAR(10)); INSERT INTO SafetyOrgs (name, country) VALUES ('Euro NCAP', 'UK'); INSERT INTO SafetyOrgs (name, country) VALUES ('ADAC', 'Germany'); INSERT INTO SafetyOrgs (name, country) VALUES ('UTAC', 'France'); INSERT INTO SafetyOrgs (name, country) VALUES ('DEKRA', 'Germany');","SELECT name FROM SafetyOrgs WHERE country IN ('UK', 'France', 'Germany') GROUP BY name HAVING COUNT(DISTINCT country) = 3;","SELECT name FROM SafetyOrgs WHERE country IN ('UK', 'France', 'Germany');",False,False
List the top 5 most preferred desserts among customers in the South region.,"CREATE TABLE orders (order_id INT, customer_id INT, order_date DATE, region VARCHAR(50)); CREATE TABLE order_details (order_id INT, menu_id INT, quantity_sold INT); CREATE TABLE menu (menu_id INT, menu_name VARCHAR(255), menu_category VARCHAR(50)); INSERT INTO orders (order_id, customer_id, order_date, region) VALUES (1, 1, '2022-01-01', 'South'), (2, 2, '2022-01-02', 'North'), (3, 3, '2022-01-03', 'South'); INSERT INTO order_details (order_id, menu_id, quantity_sold) VALUES (1, 1, 10), (1, 2, 5), (2, 2, 8), (2, 3, 12), (3, 4, 20); INSERT INTO menu (menu_id, menu_name, menu_category) VALUES (1, 'Chocolate Cake', 'Dessert'), (2, 'Cheese Cake', 'Dessert'), (3, 'Beef Burger', 'Main Course'), (4, 'Ice Cream', 'Dessert');","SELECT menu_name, SUM(quantity_sold) as total_quantity FROM order_details o JOIN orders ON o.order_id = orders.order_id JOIN menu m ON o.menu_id = m.menu_id WHERE region = 'South' AND menu_category = 'Dessert' GROUP BY menu_name ORDER BY total_quantity DESC LIMIT 5;","SELECT m.menu_name, SUM(od.quantity_sold) AS total_quantity_sold
FROM menu m
JOIN order_details od ON m.menu_id = od.menu_id
JOIN orders o ON od.order_id = o.order_id
WHERE o.region = 'South' AND m.menu_category = 'Dessert'
GROUP BY m.menu_name
ORDER BY total_quantity_sold DESC
LIMIT 5;",False,False
"List all food justice organizations in Africa, along with the number of projects they have implemented.","CREATE TABLE food_justice_orgs (org_id INT, org_name TEXT, country TEXT, num_projects INT); INSERT INTO food_justice_orgs (org_id, org_name, country, num_projects) VALUES (1, 'Org A', 'Kenya', 10), (2, 'Org B', 'Nigeria', 7), (3, 'Org C', 'South Africa', 15);","SELECT org_name, num_projects FROM food_justice_orgs WHERE country = 'Africa';","SELECT org_name, num_projects FROM food_justice_orgs WHERE country IN ('Kenya', 'Nigeria', 'South Africa');",False,False
List the top 5 most popular sizes among customers,"CREATE TABLE orders (id SERIAL PRIMARY KEY, customer_id INTEGER, size VARCHAR(10)); INSERT INTO orders (customer_id, size) VALUES (1, 'M'), (2, 'XL'), (3, 'S'), (1, 'L'), (2, 'XL'), (3, 'M'), (4, 'XS');","SELECT size, COUNT(*) as popularity FROM orders GROUP BY size ORDER BY popularity DESC LIMIT 5;","SELECT size, COUNT(*) AS count FROM orders GROUP BY size ORDER BY count DESC LIMIT 5;",False,False
"What is the total number of likes and comments on posts mentioning the brand ""Tesla"" in the automotive industry, in Germany, in the past month?","CREATE TABLE posts (id INT, user_id INT, brand_mentioned VARCHAR(255), likes INT, comments INT, post_time DATETIME);","SELECT SUM(likes + comments) FROM posts WHERE brand_mentioned = 'Tesla' AND industry = 'automotive' AND country = 'Germany' AND post_time > DATE_SUB(NOW(), INTERVAL 1 MONTH);","SELECT SUM(likes) + SUM(comments) FROM posts WHERE brand_mentioned = 'Tesla' AND post_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH);",False,False
"List all the government programs in the state of California that have a budget over $1M and their respective budgets, ordered from highest to lowest budget.","CREATE TABLE programs (name VARCHAR(255), budget FLOAT, state VARCHAR(255)); INSERT INTO programs (name, budget, state) VALUES ('Program A', 1.2, 'California'), ('Program B', 2.5, 'California'), ('Program C', 1.8, 'California'), ('Program D', 0.9, 'California');","SELECT name, budget FROM programs WHERE state = 'California' AND budget > 1000000.0 ORDER BY budget DESC;","SELECT name, budget FROM programs WHERE state = 'California' AND budget > 1000000 ORDER BY budget DESC;",False,False
How many farmers are there in each location?,"CREATE TABLE farmers (id INT, name VARCHAR(50), age INT, location VARCHAR(50)); INSERT INTO farmers (id, name, age, location) VALUES (1, 'John Doe', 45, 'Ruralville'); INSERT INTO farmers (id, name, age, location) VALUES (2, 'Jane Smith', 50, 'Farmtown');","SELECT location, COUNT(*) FROM farmers GROUP BY location;","SELECT location, COUNT(*) AS num_farmers FROM farmers GROUP BY location;",False,False
What is the total installed capacity of renewable energy projects by city?,"CREATE TABLE renewable_energy_projects (project_id INT, project_name VARCHAR(50), city VARCHAR(50), installed_capacity FLOAT); INSERT INTO renewable_energy_projects (project_id, project_name, city, installed_capacity) VALUES (1, 'Solar Farm 1', 'CityA', 10000.0), (2, 'Wind Farm 1', 'CityB', 15000.0), (3, 'Hydro Plant 1', 'CityA', 20000.0);","SELECT city, SUM(installed_capacity) FROM renewable_energy_projects GROUP BY city;","SELECT city, SUM(installed_capacity) FROM renewable_energy_projects GROUP BY city;",True,True
What is the average number of papers published by graduate students in the English department?,"CREATE SCHEMA if not exists higher_ed;CREATE TABLE if not exists higher_ed.students(id INT, name VARCHAR(255), department VARCHAR(255));CREATE TABLE if not exists higher_ed.publications(id INT, title VARCHAR(255), author_id INT);","SELECT AVG(pub_count) FROM (SELECT author_id, COUNT(*) as pub_count FROM higher_ed.publications GROUP BY author_id) p JOIN higher_ed.students s ON p.author_id = s.id WHERE s.department = 'English';","-- No information on student's graduate status is available in the table.
-- Returning average publications per student in English department.
SELECT AVG(t1.paper_count)
FROM (
  SELECT COUNT(*) AS paper_count
  FROM higher_ed.publications AS p
  JOIN higher_ed.students AS s ON p.author_id = s.id
  WHERE s.department = 'English'
  GROUP BY p.author_id
) AS t1;",False,False
"What is the average cost of rural infrastructure projects in the province of Punjab, Pakistan, by project type and year?","CREATE TABLE projects_pakistan (project_id INT, province TEXT, project_type TEXT, year INT, cost FLOAT); INSERT INTO projects_pakistan (project_id, province, project_type, year, cost) VALUES (1, 'Punjab', 'Roads', 2018, 500000), (2, 'Punjab', 'Bridges', 2019, 700000), (3, 'Punjab', 'Irrigation', 2020, 600000);","SELECT project_type, year, AVG(cost) as avg_cost FROM projects_pakistan WHERE province = 'Punjab' GROUP BY project_type, year;","SELECT project_type, year, AVG(cost) FROM projects_pakistan WHERE province = 'Punjab' GROUP BY project_type, year;",False,False
How many marine species are in the Caribbean Sea?,"CREATE TABLE CaribbeanSea (species_name TEXT, population INT); INSERT INTO CaribbeanSea (species_name, population) VALUES ('Manatee', 6500), ('Coral', 50000);",SELECT COUNT(species_name) FROM CaribbeanSea WHERE species_name != 'Coral';,SELECT COUNT(*) FROM CaribbeanSea;,False,False
Which indigenous art forms from Asia have been recognized by UNESCO as Masterpieces of the Oral and Intangible Heritage of Humanity?,"CREATE TABLE intangible_heritage (id INT, name VARCHAR(50), location VARCHAR(50), status VARCHAR(50), PRIMARY KEY(id)); INSERT INTO intangible_heritage (id, name, location, status) VALUES (1, 'Kutiyattam', 'India, Asia', 'Masterpiece'), (2, 'Noh', 'Japan, Asia', 'Masterpiece'), (3, 'Batik', 'Indonesia, Asia', 'Masterpiece');","SELECT i.name, i.location, i.status FROM intangible_heritage i WHERE i.status = 'Masterpiece';",SELECT name FROM intangible_heritage WHERE location LIKE '%Asia%' AND status = 'Masterpiece';,False,False
How many total tickets were sold for outdoor concerts in the 'events' table?,"CREATE TABLE events (id INT PRIMARY KEY, event_name VARCHAR(100), event_type VARCHAR(50), num_tickets_sold INT);",SELECT SUM(num_tickets_sold) AS total_tickets_sold FROM events WHERE event_type = 'Outdoor Concert';,SELECT SUM(num_tickets_sold) FROM events WHERE event_type = 'outdoor concerts';,False,False
"What is the average IMDb rating for movies and TV shows produced in Japan, and their respective total production budgets?","CREATE TABLE Movies (MovieID INT, Title VARCHAR(255), Genre VARCHAR(50), ReleaseYear INT, ProductionBudget DECIMAL(10,2), Country VARCHAR(50), IMDbRating DECIMAL(3,2)); CREATE TABLE TVShows (ShowID INT, Title VARCHAR(255), Genre VARCHAR(50), ReleaseYear INT, ProductionBudget DECIMAL(10,2), Country VARCHAR(50), IMDbRating DECIMAL(3,2));","SELECT AVG(Movies.IMDbRating) AS Avg_Movie_Rating, AVG(TVShows.IMDbRating) AS Avg_TVShow_Rating, SUM(Movies.ProductionBudget) AS Total_Movie_Budget, SUM(TVShows.ProductionBudget) AS Total_TVShow_Budget FROM Movies INNER JOIN TVShows ON 1=1 WHERE Movies.Country = 'Japan' AND TVShows.Country = 'Japan';","SELECT AVG(IMDbRating) AS average_imdb_rating, SUM(ProductionBudget) AS total_production_budget
FROM (
    SELECT IMDbRating, ProductionBudget FROM Movies WHERE Country = 'Japan'
    UNION ALL
    SELECT IMDbRating, ProductionBudget FROM TVShows WHERE Country = 'Japan'
) AS combined;",False,False
What is the distribution of explainability scores for creative AI algorithms by continent?,"CREATE TABLE creative_ai_algorithm_explainability_scores (issue_id INT PRIMARY KEY, ai_algorithm_id INT, explainability_score FLOAT, continent VARCHAR(255));","SELECT continent, AVG(explainability_score) AS avg_explainability_score FROM creative_ai_algorithm_explainability_scores GROUP BY continent;","SELECT continent, explainability_score, COUNT(*) AS frequency FROM creative_ai_algorithm_explainability_scores GROUP BY continent, explainability_score;",False,False
What is the total energy storage capacity for each energy storage technology in the storage table?,"CREATE TABLE storage (id INT, name VARCHAR(50), type VARCHAR(50), capacity INT, location VARCHAR(50));","SELECT type, SUM(capacity) as total_capacity FROM storage GROUP BY type ORDER BY total_capacity DESC;","SELECT type, SUM(capacity) FROM storage GROUP BY type;",False,False
What is the total cost of ingredients for the 'Falafel Wrap' for the month of June 2022?,"CREATE TABLE Ingredients (ingredient_id INT, ingredient_name TEXT, dish_id INT, cost FLOAT); INSERT INTO Ingredients (ingredient_id, ingredient_name, dish_id, cost) VALUES (1, 'Falafel', 3, 3.0);","SELECT SUM(cost) FROM Ingredients WHERE dish_id IN (SELECT dish_id FROM Dishes WHERE dish_name = 'Falafel Wrap') AND ingredient_name NOT IN ('Hummus', 'Pita Bread');",SELECT SUM(cost) FROM Ingredients WHERE ingredient_name LIKE '%Falafel%',False,False
What is the total number of electric vehicles (in thousands) in China as of 2021?,"CREATE TABLE electric_vehicles (id INT, country TEXT, year INT, number_thousands FLOAT); INSERT INTO electric_vehicles (id, country, year, number_thousands) VALUES (1, 'China', 2020, 1500.1), (2, 'China', 2021, 1800.2);",SELECT SUM(number_thousands) FROM electric_vehicles WHERE country = 'China' AND year = 2021;,SELECT SUM(number_thousands) FROM electric_vehicles WHERE country = 'China' AND year = 2021;,True,True
How many goals were scored by the top scorer in 2022?,"CREATE TABLE scores (id INT, player TEXT, team TEXT, goals INT, year INT); INSERT INTO scores (id, player, team, goals, year) VALUES (1, 'Mia Jones', 'Sapphires', 45, 2022); INSERT INTO scores (id, player, team, goals, year) VALUES (2, 'Liam Brown', 'Thunder', 38, 2022);","SELECT player, SUM(goals) FROM scores WHERE year = 2022 GROUP BY player ORDER BY SUM(goals) DESC LIMIT 1;",SELECT MAX(goals) FROM scores WHERE year = 2022;,False,False
What is the average heart rate for each member during a workout?,"CREATE TABLE wearable_metrics (member_id INT, heart_rate INT, workout_date DATE, workout_duration TIME); INSERT INTO wearable_metrics (member_id, heart_rate, workout_date, workout_duration) VALUES (1, 120, '2022-01-01', '01:00:00'), (1, 130, '2022-01-02', '01:30:00'), (2, 140, '2022-01-01', '02:00:00'), (2, 150, '2022-01-03', '01:15:00'), (3, 160, '2022-01-02', '01:00:00'), (3, 170, '2022-01-03', '01:30:00'), (3, 180, '2022-01-04', '02:00:00'), (4, 190, '2022-01-04', '01:15:00');","SELECT member_id, AVG(heart_rate) FROM wearable_metrics GROUP BY member_id;","SELECT member_id, AVG(heart_rate) AS average_heart_rate FROM wearable_metrics GROUP BY member_id;",False,False
What is the earliest launch date for a satellite in the 'Satellites' table?,"CREATE TABLE Satellites (Satellite_ID INT, Name VARCHAR(100), Launch_Date DATE); INSERT INTO Satellites (Satellite_ID, Name, Launch_Date) VALUES (1, 'Starlink-1', '2019-05-24'), (2, 'Starlink-2', '2019-06-11');",SELECT MIN(Launch_Date) FROM Satellites;,SELECT MIN(Launch_Date) FROM Satellites;,True,True
What is the monthly production trend for a specific well?,"CREATE TABLE production (prod_id INT, well_id INT, prod_date DATE, production_rate FLOAT); INSERT INTO production (prod_id, well_id, prod_date, production_rate) VALUES (1, 1, '2020-01-01', 1000), (2, 1, '2020-02-01', 1100), (3, 1, '2020-03-01', 1200), (4, 1, '2020-04-01', 1300), (5, 1, '2020-05-01', 1400);","SELECT prod_date, production_rate, LAG(production_rate, 1) OVER (ORDER BY prod_date) AS previous_month_rate FROM production WHERE well_id = 1;","SELECT prod_date, production_rate FROM production WHERE well_id = 1;",False,False
What is the maximum construction labor cost per hour in Oregon?,"CREATE TABLE labor_costs (id INT, task VARCHAR(50), cost FLOAT, state VARCHAR(50)); INSERT INTO labor_costs (id, task, cost, state) VALUES (1, 'Concrete Work', 50.00, 'Oregon'); INSERT INTO labor_costs (id, task, cost, state) VALUES (2, 'Electrical Work', 60.50, 'Oregon');",SELECT MAX(cost) FROM labor_costs WHERE state = 'Oregon',SELECT MAX(cost) FROM labor_costs WHERE state = 'Oregon';,False,False
How many cases were handled by each restorative justice center per month?,"CREATE TABLE restorative_justice_center (case_id INT, center_name VARCHAR(50), case_date DATE); INSERT INTO restorative_justice_center VALUES (1, 'Center A', '2021-01-01'), (2, 'Center B', '2021-01-05'), (3, 'Center A', '2021-02-02'), (4, 'Center C', '2021-02-06');","SELECT center_name, DATE_FORMAT(case_date, '%Y-%m') AS case_month, COUNT(*) AS cases_per_month FROM restorative_justice_center GROUP BY center_name, case_month;","SELECT center_name,
       STRFTIME('%Y-%m', case_date) AS case_month,
       COUNT(*) AS case_count
FROM restorative_justice_center
GROUP BY center_name, case_month
ORDER BY center_name, case_month;",False,False
What was the total amount of funding received by women-led agricultural projects in Kenya in 2020?,"CREATE TABLE Agricultural_Projects (Project_ID INT, Project_Name TEXT, Location TEXT, Funding_Received DECIMAL, Led_By TEXT, Year INT); INSERT INTO Agricultural_Projects (Project_ID, Project_Name, Location, Funding_Received, Led_By, Year) VALUES (1, 'Precision Farming Initiative', 'Kenya', 50000, 'Women', 2020);",SELECT SUM(Funding_Received) FROM Agricultural_Projects WHERE Led_By = 'Women' AND Year = 2020 AND Location = 'Kenya';,SELECT SUM(Funding_Received) FROM Agricultural_Projects WHERE Location = 'Kenya' AND Led_By = 'Women' AND Year = 2020,False,False
Find the average price of elements with symbol 'E',"CREATE TABLE elements_price (element_id INT, price FLOAT, PRIMARY KEY (element_id, price)); CREATE TABLE elements (id INT PRIMARY KEY, name VARCHAR(255), symbol VARCHAR(3), weight FLOAT, element_id INT, FOREIGN KEY (element_id) REFERENCES elements_price(element_id));",SELECT AVG(price) FROM elements_price WHERE element_id IN (SELECT id FROM elements WHERE symbol LIKE 'E%');,SELECT AVG(T1.price) FROM elements_price AS T1 INNER JOIN elements AS T2 ON T1.element_id  =  T2.element_id WHERE T2.symbol  =  'E',False,False
"Calculate the percentage of projects that are on time, in the Central region, for the year 2021.","CREATE TABLE ProjectTimeline (ProjectID int, Region varchar(20), Year int, OnTime bit); INSERT INTO ProjectTimeline (ProjectID, Region, Year, OnTime) VALUES (1, 'Central', 2021, 1), (2, 'Northeast', 2021, 0), (3, 'Central', 2021, 1);","SELECT Region, PERCENTAGE(SUM(OnTime) OVER (PARTITION BY Region) / COUNT(*) OVER (PARTITION BY Region)) as PercentageOnTime FROM ProjectTimeline WHERE Region = 'Central' AND Year = 2021;",SELECT CAST(SUM(CASE WHEN OnTime = 1 THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(*) FROM ProjectTimeline WHERE Region = 'Central' AND Year = 2021,False,False
"Determine the number of unique games played by players who joined esports events in each country, per month, and the number of unique virtual reality devices they use.","CREATE TABLE EventDates (EventID INT, EventDate DATE); INSERT INTO EventDates (EventID, EventDate) VALUES (1, '2022-01-01'), (2, '2022-02-01'), (3, '2022-01-15'); CREATE TABLE EventParticipation (EventID INT, PlayerID INT);","SELECT E.EventCountry, EXTRACT(MONTH FROM E.EventDate) AS Month, COUNT(DISTINCT EP.PlayerID) AS PlayersJoined, COUNT(DISTINCT VR.VRDevice) AS VRDevices, COUNT(DISTINCT G.GameID) AS UniqueGames FROM Players P JOIN EventParticipation EP ON P.PlayerID = EP.PlayerID JOIN EventDates E ON EP.EventID = E.EventID JOIN GamePlay G ON P.PlayerID = G.PlayerID JOIN VRAdoption VR ON P.PlayerID = VR.PlayerID GROUP BY E.EventCountry, EXTRACT(MONTH FROM E.EventDate)","-- Unable to provide an adequate query for the request.
-- There is no information on games, countries or VR devices in the provided schema.",False,False
List all Shariah-compliant financial products with their descriptions.,"CREATE TABLE shariah_compliant_products (product_id INT, product_name TEXT, description TEXT);","SELECT product_name, description  FROM shariah_compliant_products;","SELECT product_name, description FROM shariah_compliant_products;",False,False
What is the average duration of construction projects in New York?,"CREATE TABLE project_timeline (id INT, project_id INT, start_date DATE, end_date DATE); INSERT INTO project_timeline (id, project_id, start_date, end_date) VALUES (1, 1, '2021-01-01', '2021-06-30'); INSERT INTO project_timeline (id, project_id, start_date, end_date) VALUES (2, 2, '2021-03-01', '2021-08-31'); INSERT INTO project_timeline (id, project_id, start_date, end_date) VALUES (3, 3, '2021-05-01', '2021-11-30');","SELECT AVG(DATEDIFF(end_date, start_date)) as avg_duration_days FROM project_timeline WHERE project_id IN (SELECT id FROM projects WHERE state = 'New York');",SELECT AVG(JULIANDAY(end_date) - JULIANDAY(start_date)) FROM project_timeline;,False,False
How many volunteers are registered in the 'Volunteers' table?,"CREATE TABLE Volunteers (id INT, name VARCHAR(50), registered_date DATE); INSERT INTO Volunteers (id, name, registered_date) VALUES (1, 'John Doe', '2021-01-01'), (2, 'Jane Smith', '2021-02-01');",SELECT COUNT(*) FROM Volunteers,SELECT COUNT(*) FROM Volunteers;,False,False
What is the total revenue generated by each game genre?,"CREATE TABLE GameSales (GameID INT, GameName VARCHAR(50), Genre VARCHAR(50), Revenue DECIMAL(10, 2)); INSERT INTO GameSales (GameID, GameName, Genre, Revenue) VALUES (1, 'Fortnite', 'Battle Royale', 1000.00), (2, 'Minecraft', 'Sandbox', 500.00), (3, 'Call of Duty', 'FPS', 800.00), (4, 'The Sims', 'Life Simulation', 700.00);","SELECT Genre, SUM(Revenue) as TotalRevenue FROM GameSales GROUP BY Genre;","SELECT Genre, SUM(Revenue) AS TotalRevenue FROM GameSales GROUP BY Genre;",True,True
Who is the artist with the most concert tickets sold in the month of 'November'?,"CREATE TABLE concert_sales (id INT, artist VARCHAR(255), city VARCHAR(255), date DATE, tickets_sold INT); INSERT INTO concert_sales (id, artist, city, date, tickets_sold) VALUES (1, 'Rosalía', 'Barcelona', '2022-11-01', 20000);","SELECT artist, SUM(tickets_sold) AS total_tickets_sold FROM concert_sales WHERE date BETWEEN '2022-11-01' AND '2022-11-30' GROUP BY artist ORDER BY total_tickets_sold DESC LIMIT 1;","SELECT artist FROM concert_sales WHERE strftime('%m', date) = '11' GROUP BY artist ORDER BY SUM(tickets_sold) DESC LIMIT 1;",False,False
What is the average age of unvaccinated individuals in NYC?,"CREATE TABLE individual (age INT, city TEXT, vaccination_status TEXT);",SELECT AVG(age) FROM individual i WHERE i.city = 'NYC' AND i.vaccination_status = 'unvaccinated';,SELECT AVG(age) FROM individual WHERE city = 'NYC' AND vaccination_status = 'unvaccinated';,False,False
What is the number of players who have achieved a high score in each game genre?,"CREATE TABLE PlayerScores (PlayerID INT, GameID INT, HighScore INT); INSERT INTO PlayerScores (PlayerID, GameID, HighScore) VALUES (1, 1, 1000), (2, 2, 2000), (3, 1, 1500), (4, 3, 2500), (5, 2, 2200), (6, 1, 3000), (7, 4, 3500), (8, 3, 3000), (9, 2, 3300), (10, 5, 4000);   CREATE TABLE GameGenres (GameID INT, Genre VARCHAR(50)); INSERT INTO GameGenres (GameID, Genre) VALUES (1, 'Action'), (2, 'Strategy'), (3, 'RPG'), (4, 'Simulation'), (5, 'Puzzle');","SELECT Genre, COUNT(*) as PlayerCount FROM PlayerScores INNER JOIN GameGenres ON PlayerScores.GameID = GameGenres.GameID WHERE HighScore >= (SELECT AVG(HighScore) FROM PlayerScores) GROUP BY Genre;","SELECT gg.Genre, COUNT(DISTINCT ps.PlayerID) AS NumberOfPlayers
FROM PlayerScores ps
JOIN GameGenres gg ON ps.GameID = gg.GameID
GROUP BY gg.Genre;",False,False
Find total assets of clients with a last transaction date in 2021 Q4,"CREATE TABLE clients (client_id INT PRIMARY KEY, name VARCHAR(100), last_transaction_date DATE); INSERT INTO clients (client_id, name, last_transaction_date) VALUES (1, 'John Doe', '2021-12-15');","SELECT SUM(assets) FROM (SELECT client_id, assets FROM client_assets WHERE client_id IN (SELECT client_id FROM clients WHERE last_transaction_date >= '2021-10-01' AND last_transaction_date <= '2021-12-31')) clients_assets_q4","-- There's no asset information in the provided schema.  The query below returns the number of clients.
-- To calculate total assets, you need a table with asset information linked to client_id.

SELECT COUNT(*) 
FROM clients
WHERE last_transaction_date BETWEEN '2021-10-01' AND '2021-12-31';",False,False
What is the average price of sustainable fabrics?,"CREATE TABLE sustainable_fabrics (id INT, name TEXT, price DECIMAL); INSERT INTO sustainable_fabrics (id, name, price) VALUES (1, 'Organic Cotton', 2.5), (2, 'Recycled Polyester', 3.2), (3, 'Hemp', 2.8);",SELECT AVG(price) FROM sustainable_fabrics;,SELECT AVG(price) FROM sustainable_fabrics;,True,True
What are the top 2 most frequently ordered vegetarian items?,"CREATE TABLE menu_items (item_id INT, item_name TEXT, is_vegetarian BOOLEAN); INSERT INTO menu_items (item_id, item_name, is_vegetarian) VALUES (1, 'Hamburger', false), (2, 'Pizza', true), (3, 'Chicken Sandwich', false);","SELECT item_name, COUNT(*) as order_count FROM menu_items WHERE is_vegetarian = true GROUP BY item_name ORDER BY order_count DESC LIMIT 2;","-- There's no order information in the provided schema, so this query returns the top 2 vegetarian items.  To get the most frequently ordered, an orders table with item_id would be needed.
SELECT item_name FROM menu_items WHERE is_vegetarian = TRUE LIMIT 2;",False,False
How many matches did each soccer team in the English Premier League play in the 2021-2022 season?,"CREATE TABLE english_premier_league (team_id INT, team_name VARCHAR(50), matches_played INT); INSERT INTO english_premier_league (team_id, team_name, matches_played) VALUES (1, 'Manchester City', 38), (2, 'Liverpool', 38), (3, 'Chelsea', 38);","SELECT team_name, matches_played FROM english_premier_league;","SELECT team_name, matches_played FROM english_premier_league;",True,True
What is the minimum donation amount made in India in 2019?,"CREATE TABLE donations (id INT, donor_name TEXT, country TEXT, donation_amount DECIMAL, donation_date DATE); INSERT INTO donations (id, donor_name, country, donation_amount, donation_date) VALUES (1, 'Ramesh Kumar', 'India', 25.00, '2019-12-15'); INSERT INTO donations (id, donor_name, country, donation_amount, donation_date) VALUES (2, 'Sita Patel', 'India', 50.00, '2019-07-23');",SELECT MIN(donation_amount) FROM donations WHERE country = 'India' AND YEAR(donation_date) = 2019;,"SELECT MIN(donation_amount) FROM donations WHERE country = 'India' AND STRFTIME('%Y', donation_date) = '2019';",False,False
How many fair trade certified factories are located in Asia?,"CREATE TABLE factories (factory_id INT, factory_name VARCHAR(50), location VARCHAR(50), fair_trade_certified BOOLEAN); INSERT INTO factories (factory_id, factory_name, location, fair_trade_certified) VALUES (1, 'Green Factory', 'Asia', true), (2, 'Eco Factory', 'US', false), (3, 'Sustainable Factory', 'Europe', true);",SELECT COUNT(*) FROM factories WHERE location = 'Asia' AND fair_trade_certified = true;,SELECT COUNT(*) FROM factories WHERE location = 'Asia' AND fair_trade_certified = TRUE;,True,True
What is the total number of companies founded by solo founders in the biotech industry?,"CREATE TABLE company (id INT, name TEXT, founding_date DATE, industry TEXT, headquarters TEXT, founder_count INT);",SELECT COUNT(*) FROM company WHERE founder_count = 1 AND industry = 'biotech';,SELECT COUNT(*) FROM company WHERE founder_count = 1 AND industry = 'biotech';,True,True
What is the maximum billing rate for attorneys in the 'corporate' department?,"CREATE TABLE attorneys (id INT, name VARCHAR(50), department VARCHAR(50), billing_rate DECIMAL(5,2)); INSERT INTO attorneys (id, name, department, billing_rate) VALUES (1, 'John Doe', 'corporate', 400.00), (2, 'Jane Smith', 'corporate', 450.00), (3, 'Bob Johnson', 'litigation', 300.00);",SELECT MAX(billing_rate) FROM attorneys WHERE department = 'corporate';,SELECT MAX(billing_rate) FROM attorneys WHERE department = 'corporate';,True,True
"Delete all fire incidents in the city of Dallas that occurred before January 1st, 2021.","CREATE TABLE dallas_fire_incidents (id INT, incident_date TIMESTAMP); INSERT INTO dallas_fire_incidents (id, incident_date) VALUES (1, '2020-12-31 23:59:59');",DELETE FROM dallas_fire_incidents WHERE incident_date < '2021-01-01 00:00:00';,DELETE FROM dallas_fire_incidents WHERE incident_date < '2021-01-01';,False,False
What is the average visitor count for exhibitions held in each country?,"CREATE TABLE exhibitions (id INT, country VARCHAR(50), visitor_count INT); INSERT INTO exhibitions (id, country, visitor_count) VALUES (1, 'USA', 300), (2, 'Canada', 200), (3, 'Mexico', 100);","SELECT country, AVG(visitor_count) FROM exhibitions GROUP BY country;","SELECT country, AVG(visitor_count) FROM exhibitions GROUP BY country;",True,True
Add a new animal 'Jaguar' to the 'habitat_preservation' program,"CREATE TABLE animal_population (animal_id INT, animal_name VARCHAR(50), program VARCHAR(50), added_date DATE); INSERT INTO animal_population (animal_id, animal_name, program, added_date) VALUES (1, 'Grizzly Bear', 'habitat_preservation', '2022-01-01'), (2, 'Gray Wolf', 'community_education', '2022-02-01'), (3, 'Bald Eagle', 'habitat_preservation', '2022-03-01'), (4, 'Red Fox', 'community_education', '2022-04-01');","INSERT INTO animal_population (animal_name, program, added_date) VALUES ('Jaguar', 'habitat_preservation', CURRENT_TIMESTAMP);","INSERT INTO animal_population (animal_name, program) VALUES ('Jaguar', 'habitat_preservation');",False,False
"What is the total funding received by companies founded in 2017, ordered by the amount of funding?","CREATE TABLE Funding (company_id INT, funding_year INT, amount INT); INSERT INTO Funding (company_id, funding_year, amount) VALUES (1, 2015, 3000000); INSERT INTO Funding (company_id, funding_year, amount) VALUES (2, 2017, 5000000); INSERT INTO Funding (company_id, funding_year, amount) VALUES (3, 2017, 7000000);","SELECT company_id, SUM(amount) as total_funding FROM Funding WHERE funding_year = 2017 GROUP BY company_id ORDER BY total_funding DESC;",SELECT SUM(amount) FROM Funding WHERE funding_year = 2017 ORDER BY amount;,False,False
Show all records in the defense_diplomacy table where the participant_country is 'China' or 'India',"CREATE TABLE defense_diplomacy (diplomacy_id INT, event_name VARCHAR(50), participant_country VARCHAR(50), event_date DATE, event_description TEXT);","SELECT * FROM defense_diplomacy WHERE participant_country IN ('China', 'India');",SELECT * FROM defense_diplomacy WHERE participant_country = 'China' OR participant_country = 'India';,False,False
What is the maximum water temperature in the AquaticFarm table for February 2022?,"CREATE TABLE AquaticFarm (date DATE, temperature FLOAT); INSERT INTO AquaticFarm (date, temperature) VALUES ('2022-02-01', 21.0), ('2022-02-02', 22.0), ('2022-02-03', 23.0);",SELECT MAX(temperature) FROM AquaticFarm WHERE MONTH(date) = 2 AND YEAR(date) = 2022;,"SELECT MAX(temperature) FROM AquaticFarm WHERE strftime('%Y-%m', date) = '2022-02';",False,False
What is the average attendance for cultural events in a given city?,"CREATE TABLE CulturalEvents (id INT, name VARCHAR(50), city VARCHAR(50), attendance INT); INSERT INTO CulturalEvents (id, name, city, attendance) VALUES (1, 'Theater Play', 'New York', 500), (2, 'Art Exhibit', 'New York', 300), (3, 'Music Concert', 'Los Angeles', 700);",SELECT AVG(attendance) FROM CulturalEvents WHERE city = 'New York';,SELECT AVG(attendance) FROM CulturalEvents WHERE city = 'New York';,True,True
What is the maximum workout duration for users from Brazil?,"CREATE TABLE Workout (user_id INT, workout_duration INT, country VARCHAR(50)); INSERT INTO Workout (user_id, workout_duration, country) VALUES (1, 30, 'Brazil'), (2, 40, 'USA'), (3, 50, 'Brazil'), (4, 60, 'Brazil');",SELECT MAX(workout_duration) FROM Workout WHERE country = 'Brazil';,SELECT MAX(workout_duration) FROM Workout WHERE country = 'Brazil';,True,True
What is the total funding received by companies founded by people who identify as LGBTQ+ in the biotech sector?,"CREATE TABLE companies (id INT, name TEXT, industry TEXT, founders_lgbtq BOOLEAN, funding FLOAT);",SELECT SUM(funding) FROM companies WHERE founders_lgbtq = true AND industry = 'biotech';,SELECT SUM(funding) FROM companies WHERE founders_lgbtq = TRUE AND industry = 'biotech';,True,True
Show the number of food safety violations for restaurants located in 'Downtown' area.,"CREATE TABLE restaurants (restaurant_id INT, name VARCHAR(255), location VARCHAR(255)); CREATE TABLE inspections (inspection_id INT, restaurant_id INT, violation_count INT);","SELECT r.name, SUM(i.violation_count) as total_violations FROM inspections i JOIN restaurants r ON i.restaurant_id = r.restaurant_id WHERE r.location = 'Downtown' GROUP BY r.name;","SELECT SUM(I.violation_count) AS TotalViolations
FROM restaurants R
JOIN inspections I ON R.restaurant_id = I.restaurant_id
WHERE R.location = 'Downtown';",False,False
Delete all records of phishing attempts originating from the 'Africa' region in the past week.,"CREATE TABLE phishing_attempts (id INT, ip_address VARCHAR(15), region VARCHAR(100), attack_date DATE); INSERT INTO phishing_attempts (id, ip_address, region, attack_date) VALUES (1, '192.168.1.1', 'Africa', '2021-11-01'), (2, '10.0.0.1', 'Europe', '2021-12-05'), (3, '192.168.1.1', 'Africa', '2021-12-12');","DELETE FROM phishing_attempts WHERE region = 'Africa' AND attack_date >= DATE_SUB(CURRENT_DATE, INTERVAL 1 WEEK);","DELETE FROM phishing_attempts WHERE region = 'Africa' AND attack_date >= DATE('now', '-7 days');",False,False
How many recycling centers are in the 'Urban' area with a capacity greater than 5000 tons?,"CREATE TABLE RecyclingCenters (id INT, area VARCHAR(20), capacity INT); INSERT INTO RecyclingCenters (id, area, capacity) VALUES (1, 'Urban', 6000);",SELECT COUNT(*) FROM RecyclingCenters WHERE area = 'Urban' AND capacity > 5000;,SELECT COUNT(*) FROM RecyclingCenters WHERE area = 'Urban' AND capacity > 5000;,True,True
What is the total billing amount by case outcome?,"CREATE TABLE Cases (CaseID int, Outcome varchar(10), BillingID int); INSERT INTO Cases VALUES (1, 'Won', 1), (2, 'Won', 2), (3, 'Lost', 3), (4, 'Lost', 4); CREATE TABLE Billing (BillingID int, Amount decimal(10,2)); INSERT INTO Billing VALUES (1, 500.00), (2, 750.00), (3, 300.00), (4, 600.00);","SELECT C.Outcome, SUM(B.Amount) as TotalBilling FROM Cases C JOIN Billing B ON C.BillingID = B.BillingID GROUP BY C.Outcome;","SELECT c.Outcome, SUM(b.Amount) AS TotalBillingAmount
FROM Cases c
JOIN Billing b ON c.BillingID = b.BillingID
GROUP BY c.Outcome;",False,False
What is the name and age of the youngest inmate in the prison table?,"CREATE TABLE prison (id INT, name TEXT, security_level TEXT, age INT); INSERT INTO prison (id, name, security_level, age) VALUES (1, 'John Doe', 'low_security', 25); INSERT INTO prison (id, name, security_level, age) VALUES (2, 'Jane Smith', 'medium_security', 35);","SELECT name, age FROM prison ORDER BY age LIMIT 1;","SELECT name, age FROM prison ORDER BY age LIMIT 1;",True,True
Delete workforce records from factories that do not follow ethical manufacturing guidelines.,"CREATE TABLE factories (factory_id INT, ethical_manufacturing BOOLEAN); INSERT INTO factories VALUES (1, true), (2, false), (3, true); CREATE TABLE workforce (worker_id INT, factory_id INT); INSERT INTO workforce VALUES (1, 1), (2, 1), (3, 2), (4, 3);",DELETE FROM workforce w WHERE NOT EXISTS (SELECT 1 FROM factories f WHERE f.factory_id = w.factory_id AND f.ethical_manufacturing = true);,DELETE FROM workforce WHERE factory_id IN (SELECT factory_id FROM factories WHERE ethical_manufacturing = FALSE);,False,False
Which are the top 5 ports with the most cargo weight handled in 2022?,"CREATE TABLE Port (port_id INT, port_name TEXT, country TEXT); INSERT INTO Port (port_id, port_name, country) VALUES (1, 'Port of Shanghai', 'China'); INSERT INTO Port (port_id, port_name, country) VALUES (2, 'Port of Singapore', 'Singapore'); CREATE TABLE Cargo (cargo_id INT, port_id INT, weight FLOAT, handling_date DATE); INSERT INTO Cargo (cargo_id, port_id, weight, handling_date) VALUES (1, 1, 150000.0, '2022-01-01');","SELECT p.port_name, SUM(c.weight) as total_weight FROM Port p JOIN Cargo c ON p.port_id = c.port_id WHERE handling_date >= '2022-01-01' AND handling_date < '2023-01-01' GROUP BY p.port_name ORDER BY total_weight DESC LIMIT 5;","SELECT
  p.port_name
FROM Port AS p
JOIN Cargo AS c
  ON p.port_id = c.port_id
WHERE
  STRFTIME('%Y', c.handling_date) = '2022'
GROUP BY
  p.port_name
ORDER BY
  SUM(c.weight) DESC
LIMIT 5;",False,False
What is the average account balance for customers in the Southeast region?,"CREATE TABLE customers (customer_id INT, name VARCHAR(50), region VARCHAR(20), account_balance DECIMAL(10, 2));",SELECT AVG(account_balance) FROM customers WHERE region = 'Southeast';,SELECT AVG(account_balance) FROM customers WHERE region = 'Southeast';,True,True
"What is the total number of public transportation trips taken in the city of San Francisco, including all routes, for the month of January 2023?","CREATE TABLE public_transportation (route VARCHAR(20), trip_count INT, trip_date DATE); INSERT INTO public_transportation (route, trip_count, trip_date) VALUES ('Route 10', 1000, '2023-01-01');",SELECT SUM(trip_count) FROM public_transportation WHERE trip_date BETWEEN '2023-01-01' AND '2023-01-31';,"SELECT SUM(trip_count) FROM public_transportation WHERE strftime('%Y-%m', trip_date) = '2023-01'",False,False
What is the minimum safety rating of Italian cars?,"CREATE TABLE Safety_Testing (year INT, make VARCHAR(50), model VARCHAR(50), rating FLOAT); INSERT INTO Safety_Testing (year, make, model, rating) VALUES (2022, 'Fiat', '500', 4.3); INSERT INTO Safety_Testing (year, make, model, rating) VALUES (2022, 'Alfa Romeo', 'Giulia', 4.5);",SELECT MIN(rating) FROM Safety_Testing WHERE make = 'Italian';,SELECT MIN(rating) FROM Safety_Testing WHERE make = 'Fiat' OR make = 'Alfa Romeo';,False,False
What is the total number of fishing vessels in the Indian Ocean that are not compliant with maritime law?,"CREATE TABLE indian_ocean_fishingvessels (id INT, is_commercial BOOLEAN, is_compliant BOOLEAN);",SELECT SUM(CASE WHEN is_commercial = TRUE AND is_compliant = FALSE THEN 1 ELSE 0 END) FROM indian_ocean_fishingvessels;,SELECT COUNT(*) FROM indian_ocean_fishingvessels WHERE is_compliant = FALSE;,False,False
"What is the total number of workers in the 'Education' industry who are part of a union and earn more than $60,000?","CREATE TABLE workers (id INT, industry VARCHAR(255), salary FLOAT, union_member BOOLEAN); INSERT INTO workers (id, industry, salary, union_member) VALUES (1, 'Manufacturing', 50000.0, true), (2, 'Education', 65000.0, true), (3, 'Retail', 30000.0, false);",SELECT COUNT(*) FROM workers WHERE industry = 'Education' AND union_member = true AND salary > 60000;,SELECT COUNT(*) FROM workers WHERE industry = 'Education' AND union_member = TRUE AND salary > 60000;,True,True
"Add a new policy impact record to the ""PolicyImpact"" table","CREATE TABLE PolicyImpact (ID INT, Policy TEXT, Impact TEXT, StartDate DATE, EndDate DATE);","INSERT INTO PolicyImpact (ID, Policy, Impact, StartDate, EndDate) VALUES (3001, 'Body Cameras for Police Officers', 'Reduction in use-of-force incidents by 25%', '2021-01-01', '2022-12-31');","INSERT INTO PolicyImpact (ID, Policy, Impact, StartDate, EndDate) VALUES (NULL, NULL, NULL, NULL, NULL);",False,False
"How many teachers have completed professional development courses in each subject area, and what is the total number of courses completed?","CREATE TABLE subjects (subject_id INT, subject_name TEXT); CREATE TABLE teachers (teacher_id INT, subject_id INT); CREATE TABLE courses (course_id INT, subject_id INT, teacher_id INT); INSERT INTO subjects VALUES (1, 'Math'), (2, 'Science'), (3, 'English'); INSERT INTO teachers VALUES (1, 1), (2, 2), (3, 3); INSERT INTO courses VALUES (1, 1, 1), (2, 1, 1), (3, 2, 2), (4, 3, 3);","SELECT s.subject_name, COUNT(DISTINCT t.teacher_id) as num_teachers, COUNT(c.course_id) as total_courses_completed FROM subjects s LEFT JOIN teachers t ON s.subject_id = t.subject_id LEFT JOIN courses c ON t.teacher_id = c.teacher_id GROUP BY s.subject_id;","-- There's no information on professional development courses in the provided schema.
-- Returning a query that counts teachers per subject instead.
SELECT s.subject_name, COUNT(DISTINCT t.teacher_id) AS num_teachers, COUNT(*) AS total_courses
FROM subjects s
JOIN courses c ON s.subject_id = c.subject_id
JOIN teachers t ON c.teacher_id = t.teacher_id
GROUP BY s.subject_name;",False,False
What is the average age of patients who have completed the recovery program for depression in Canada?,"CREATE TABLE patients (patient_id INT, age INT, condition VARCHAR(50), country VARCHAR(50)); INSERT INTO patients (patient_id, age, condition, country) VALUES (1, 35, 'Depression', 'Canada'); CREATE TABLE recovery_program (program_id INT, patient_id INT, completion_date DATE); INSERT INTO recovery_program (program_id, patient_id, completion_date) VALUES (1, 1, '2020-03-01');",SELECT AVG(patients.age) FROM patients JOIN recovery_program ON patients.patient_id = recovery_program.patient_id WHERE patients.condition = 'Depression' AND patients.country = 'Canada';,"SELECT AVG(patients.age)
FROM patients
INNER JOIN recovery_program ON patients.patient_id = recovery_program.patient_id
WHERE patients.condition = 'Depression' AND patients.country = 'Canada';",False,False
Update the implementation date of 'Regulation 4' to '2015-01-01'.,"CREATE TABLE mental_health_parity (id INT, regulation VARCHAR(100), state VARCHAR(20), implementation_date DATE); INSERT INTO mental_health_parity (id, regulation, state, implementation_date) VALUES (1, 'Regulation 1', 'New York', '2011-01-01'), (2, 'Regulation 2', 'Florida', '2012-01-01'), (3, 'Regulation 4', 'California', NULL);",UPDATE mental_health_parity SET implementation_date = '2015-01-01' WHERE regulation = 'Regulation 4';,UPDATE mental_health_parity SET implementation_date = '2015-01-01' WHERE regulation = 'Regulation 4';,True,True
"What is the average caloric content of meals in each country, sorted by the highest average?","CREATE TABLE Meals (meal_id INT, meal_name TEXT, country_id INT, caloric_content FLOAT); CREATE TABLE Countries (country_id INT, country_name TEXT);","SELECT Countries.country_name, AVG(Meals.caloric_content) as avg_caloric_content FROM Meals INNER JOIN Countries ON Meals.country_id = Countries.country_id GROUP BY Countries.country_name ORDER BY avg_caloric_content DESC;","SELECT c.country_name, AVG(m.caloric_content) AS average_caloric_content
FROM Meals m
JOIN Countries c ON m.country_id = c.country_id
GROUP BY c.country_name
ORDER BY average_caloric_content DESC;",False,False
What is the minimum sustainability rating for produce suppliers in the database who supply more than 600 units of fruits and vegetables per week?,"CREATE TABLE ProduceSupplier (SupplierID INT, SustainabilityRating INT, UnitsPerWeek INT); INSERT INTO ProduceSupplier VALUES (1, 85, 550), (2, 70, 400), (3, 90, 600);",SELECT MIN(SustainabilityRating) FROM ProduceSupplier WHERE UnitsPerWeek > 600;,SELECT MIN(SustainabilityRating) FROM ProduceSupplier WHERE UnitsPerWeek > 600;,True,True
What is the minimum number of military personnel in the 'Africa' division?,"CREATE TABLE military_personnel (division TEXT, personnel INT); INSERT INTO military_personnel (division, personnel) VALUES ('Africa', 3500); INSERT INTO military_personnel (division, personnel) VALUES ('Americas', 4500);",SELECT MIN(personnel) FROM military_personnel WHERE division = 'Africa';,SELECT MIN(personnel) FROM military_personnel WHERE division = 'Africa';,True,True
Insert new records for REO production in 2023 with no impurities from the mine 'Brazil rare earths' into the reo_production table,"CREATE TABLE reo_production (id INT PRIMARY KEY, reo_type VARCHAR(50), production_year INT, impurity_level FLOAT, mine_name VARCHAR(50)); CREATE TABLE mines (id INT PRIMARY KEY, mine_name VARCHAR(50), location VARCHAR(50)); INSERT INTO mines (id, mine_name, location) VALUES (1, 'Brazil rare earths', 'Brazil');","INSERT INTO reo_production (id, reo_type, production_year, impurity_level, mine_name) SELECT NULL, 'Neodymium Oxide', 2023, 0, m.name FROM mines m WHERE m.name = 'Brazil rare earths';","INSERT INTO reo_production (reo_type, production_year, impurity_level, mine_name) SELECT 'Neodymium', 2023, 0.0, 'Brazil rare earths' UNION ALL SELECT 'Praseodymium', 2023, 0.0, 'Brazil rare earths';",False,False
Get the total number of military personnel in each region and order them by the highest number of personnel.,"CREATE TABLE military_personnel (region TEXT, personnel INTEGER); INSERT INTO military_personnel (region, personnel) VALUES ('Asia', 10000), ('Europe', 8000), ('North America', 12000);","SELECT region, SUM(personnel) FROM military_personnel GROUP BY region ORDER BY SUM(personnel) DESC","SELECT region, SUM(personnel) AS total_personnel FROM military_personnel GROUP BY region ORDER BY total_personnel DESC;",False,False
List the space missions that have had astronauts from both the US and Canada.,"CREATE TABLE SpaceMissions (mission_name VARCHAR(30), astronaut_nationality VARCHAR(20)); INSERT INTO SpaceMissions (mission_name, astronaut_nationality) VALUES ('Mission1', 'US'); INSERT INTO SpaceMissions (mission_name, astronaut_nationality) VALUES ('Mission1', 'Canada');","SELECT mission_name FROM SpaceMissions WHERE astronaut_nationality IN ('US', 'Canada') GROUP BY mission_name HAVING COUNT(DISTINCT astronaut_nationality) = 2;",SELECT mission_name FROM SpaceMissions WHERE astronaut_nationality = 'US' INTERSECT SELECT mission_name FROM SpaceMissions WHERE astronaut_nationality = 'Canada';,False,False
Delete records in the 'Employees' table with salaries less than 50000,"CREATE TABLE Employees (EmployeeID INT, FirstName VARCHAR(50), LastName VARCHAR(50), Salary INT);",DELETE FROM Employees WHERE Salary < 50000;,DELETE FROM Employees WHERE Salary < 50000;,True,True
Delete all humanitarian assistance missions conducted by Kenya in 2018.,"CREATE TABLE humanitarian_assistance (mission_id INT, country_id INT, year INT, FOREIGN KEY (country_id) REFERENCES country(id));",DELETE FROM humanitarian_assistance WHERE country_id = (SELECT id FROM country WHERE name = 'Kenya') AND year = 2018;,DELETE FROM humanitarian_assistance WHERE country_id = (SELECT id FROM country WHERE name = 'Kenya') AND year = 2018;,True,True
"Which open pedagogy resources have been accessed by students in total, and how many times have they been accessed?","CREATE TABLE student_access (student_id INT, resource_id INT, access_date DATE); CREATE TABLE open_pedagogy_resources (resource_id INT, resource_name VARCHAR(255));","SELECT r.resource_name, COUNT(s.access_date) FROM student_access s INNER JOIN open_pedagogy_resources r ON s.resource_id = r.resource_id GROUP BY r.resource_name;","SELECT opr.resource_name, COUNT(*) AS access_count FROM student_access sa JOIN open_pedagogy_resources opr ON sa.resource_id = opr.resource_id GROUP BY opr.resource_name;",False,False
What is the average water salinity in the Mediterranean Sea for the past decade?,"CREATE TABLE mediterranean_salinity (year INT, salinity FLOAT); INSERT INTO mediterranean_salinity (year, salinity) VALUES (2012, 38.4), (2013, 38.3), (2014, 38.5), (2015, 38.6), (2016, 38.7), (2017, 38.8), (2018, 38.9), (2019, 39.0), (2020, 39.1), (2021, 39.2);",SELECT AVG(salinity) FROM mediterranean_salinity WHERE year BETWEEN (SELECT EXTRACT(YEAR FROM NOW()) - 10) AND EXTRACT(YEAR FROM NOW());,SELECT AVG(salinity) FROM mediterranean_salinity WHERE year >= 2012,False,False
"What is the average word count of articles related to social justice issues in the United States, published in 2021 and 2022, partitioned by quarter?","CREATE TABLE articles (id INT, title TEXT, category TEXT, publish_date DATE, location TEXT, word_count INT); INSERT INTO articles (id, title, category, publish_date, location, word_count) VALUES (1, 'Social Justice Issue 1', 'social_justice', '2021-01-01', 'USA', 800), (2, 'Social Justice Issue 2', 'social_justice', '2022-06-05', 'USA', 1200);",SELECT AVG(word_count) OVER (PARTITION BY EXTRACT(YEAR_QUARTER FROM publish_date)) AS avg_word_count FROM articles WHERE category = 'social_justice' AND location = 'USA' AND YEAR(publish_date) BETWEEN 2021 AND 2022;,"SELECT
  AVG(word_count),
  STRFTIME('%Y-%m', publish_date) || '-Q' || CAST((STRFTIME('%m', publish_date) + 2) / 3 AS TEXT) AS quarter
FROM articles
WHERE
  category = 'social_justice' AND location = 'USA' AND STRFTIME('%Y', publish_date) IN ('2021', '2022')
GROUP BY
  quarter;",False,False
List all pollution control initiatives and their completion dates.,"CREATE TABLE pollution_control_initiatives (initiative_id INT, name TEXT, start_date DATE, completion_date DATE); INSERT INTO pollution_control_initiatives (initiative_id, name, start_date, completion_date) VALUES (1, 'Project A', '2018-01-01', '2019-01-01'), (2, 'Project B', '2019-07-01', '2020-07-01'), (3, 'Project C', '2020-03-15', '2021-03-15');","SELECT name, completion_date FROM pollution_control_initiatives;","SELECT name, completion_date FROM pollution_control_initiatives;",True,True
What is the total number of electric vehicles in the state of California and their average cost?,"CREATE TABLE ElectricVehicles (id INT, state VARCHAR(50), cost FLOAT, type VARCHAR(50)); INSERT INTO ElectricVehicles (id, state, cost, type) VALUES (1, 'California', 35000, 'Tesla Model 3'); INSERT INTO ElectricVehicles (id, state, cost, type) VALUES (2, 'California', 45000, 'Chevrolet Bolt');","SELECT SUM(cost) AS total_cost, AVG(cost) AS avg_cost FROM ElectricVehicles WHERE state = 'California' AND type LIKE '%Electric%';","SELECT COUNT(*) AS total_vehicles, AVG(cost) AS average_cost FROM ElectricVehicles WHERE state = 'California';",False,False
List the vessel names and their maximum cargo capacity for the vessels in the fleet table.,"CREATE TABLE fleet ( id INT PRIMARY KEY, name VARCHAR(255), max_cargo_capacity INT );","SELECT name, max_cargo_capacity FROM fleet;","SELECT name, max_cargo_capacity FROM fleet;",True,True
What is the total number of employees from underrepresented communities?,"CREATE TABLE employee (employee_id INT, employee_name TEXT, gender TEXT, ethnicity TEXT); INSERT INTO employee (employee_id, employee_name, gender, ethnicity) VALUES (1, 'John Doe', 'Male', 'Caucasian'), (2, 'Jane Smith', 'Female', 'African American'), (3, 'Alice Johnson', 'Female', 'Hispanic'), (4, 'Bob Brown', 'Male', 'Asian'), (5, 'Emily Davis', 'Female', 'Native American'), (6, 'Michael Lee', 'Male', 'Asian'), (7, 'Jessica Kim', 'Female', 'Asian'), (8, 'David Nguyen', 'Male', 'Asian'), (9, 'Grace Park', 'Female', 'Asian'), (10, 'Daniel Kim', 'Male', 'Asian');","SELECT COUNT(e.employee_id) as total_employees FROM employee e WHERE e.ethnicity IN ('African American', 'Hispanic', 'Native American');",SELECT COUNT(*) FROM employee WHERE ethnicity <> 'Caucasian';,False,False
Identify the hotels in the 'EMEA' region that have an adoption date for AI-powered services earlier than their competitors.,"CREATE TABLE ai_adoption (hotel_id INT, hotel_name TEXT, region TEXT, ai_adoption_date DATE); INSERT INTO ai_adoption (hotel_id, hotel_name, region, ai_adoption_date) VALUES (1, 'HotelA', 'EMEA', '2021-01-01'), (2, 'HotelB', 'EMEA', '2021-03-15'), (3, 'HotelC', 'EMEA', '2021-02-05');",SELECT hotel_name FROM ai_adoption WHERE region = 'EMEA' AND ai_adoption_date = (SELECT MIN(ai_adoption_date) FROM ai_adoption WHERE region = 'EMEA');,"SELECT hotel_name, ai_adoption_date FROM ai_adoption WHERE region = 'EMEA' ORDER BY ai_adoption_date ASC LIMIT 1;",False,False
What are the top 3 countries with the most smart contracts?,"CREATE TABLE smart_contracts (id INT, name VARCHAR(255), country VARCHAR(50)); INSERT INTO smart_contracts (id, name, country) VALUES (1, 'SC1', 'Country1'); INSERT INTO smart_contracts (id, name, country) VALUES (2, 'SC2', 'Country2'); INSERT INTO smart_contracts (id, name, country) VALUES (3, 'SC3', 'Country1'); INSERT INTO smart_contracts (id, name, country) VALUES (4, 'SC4', 'Country3'); INSERT INTO smart_contracts (id, name, country) VALUES (5, 'SC5', 'Country1'); CREATE TABLE countries (id INT, name VARCHAR(255)); INSERT INTO countries (id, name) VALUES (1, 'Country1'); INSERT INTO countries (id, name) VALUES (2, 'Country2'); INSERT INTO countries (id, name) VALUES (3, 'Country3');","SELECT country, COUNT(*) as smart_contract_count FROM smart_contracts GROUP BY country ORDER BY smart_contract_count DESC LIMIT 3;","SELECT country, COUNT(*) AS smart_contract_count FROM smart_contracts GROUP BY country ORDER BY smart_contract_count DESC LIMIT 3;",True,True
What is the landfill capacity in New York state in 2022?,"CREATE TABLE landfill_capacity (state VARCHAR(20), year INT, capacity_cubic_meters BIGINT); INSERT INTO landfill_capacity (state, year, capacity_cubic_meters) VALUES ('New York', 2021, 9876543), ('New York', 2023, 10567890);",SELECT capacity_cubic_meters FROM landfill_capacity WHERE state = 'New York' AND year = 2022;,SELECT capacity_cubic_meters FROM landfill_capacity WHERE state = 'New York' AND year = 2022;,True,True
"Create a new table language_revitalization with the following columns: id, language, program_name, location, start_year, end_year.","language_revitalization (id, language, program_name, location, start_year, end_year)","CREATE TABLE language_revitalization (id INT PRIMARY KEY, language VARCHAR(50), program_name VARCHAR(100), location VARCHAR(50), start_year INT, end_year INT);","CREATE TABLE language_revitalization (id INT, language TEXT, program_name TEXT, location TEXT, start_year INT, end_year INT);",False,False
Which cruelty-free certified products were purchased in the last month from the US region?,"CREATE TABLE product (product_id INT, product_name TEXT, is_cruelty_free BOOLEAN); CREATE TABLE purchase (purchase_id INT, product_id INT, purchase_date DATE, region TEXT); INSERT INTO product VALUES (1, 'Lipstick', true), (2, 'Moisturizer', false); INSERT INTO purchase VALUES (1, 1, '2022-01-10', 'US'), (2, 2, '2022-01-15', 'CA');",SELECT p.product_name FROM purchase p JOIN product pr ON p.product_id = pr.product_id WHERE pr.is_cruelty_free = true AND p.purchase_date >= '2022-02-01' AND p.region = 'US';,"SELECT p.product_name
FROM product p
JOIN purchase pc ON p.product_id = pc.product_id
WHERE p.is_cruelty_free = true AND pc.region = 'US' AND pc.purchase_date >= date('now', '-1 month');",False,False
What is the total square footage of properties owned by each person?,"CREATE TABLE property (id INT, sqft INT, owner_id INT); CREATE TABLE person (id INT, name VARCHAR(50));","SELECT person.name, SUM(property.sqft) FROM person INNER JOIN property ON person.id = property.owner_id GROUP BY person.name;","SELECT p.name, SUM(pr.sqft) AS total_sqft
FROM person p
JOIN property pr ON p.id = pr.owner_id
GROUP BY p.name;",False,False
How many publications were made by graduate students in the Mathematics department in the year 2020?,"CREATE TABLE GraduateStudents (StudentID INT, Name VARCHAR(50), Department VARCHAR(50), Publications INT, PublicationYear INT);",SELECT COUNT(Publications) FROM GraduateStudents WHERE Department = 'Mathematics' AND PublicationYear = 2020;,"SELECT SUM(Publications)
FROM GraduateStudents
WHERE Department = 'Mathematics' AND PublicationYear = 2020;",False,False
What is the minimum steps taken per day by users from Japan?,"CREATE TABLE steps (id INT, user_id INT, date DATE, steps INT); INSERT INTO steps (id, user_id, date, steps) VALUES (1, 1, '2022-01-01', 5000); INSERT INTO steps (id, user_id, date, steps) VALUES (2, 2, '2022-01-01', 6000); INSERT INTO steps (id, user_id, date, steps) VALUES (3, 3, '2022-01-02', 4000); INSERT INTO steps (id, user_id, date, steps) VALUES (4, 1, '2022-01-02', 7000); INSERT INTO steps (id, user_id, date, steps) VALUES (5, 4, '2022-01-01', 8000); INSERT INTO steps (id, user_id, date, steps) VALUES (6, 5, '2022-01-03', 9000); INSERT INTO steps (id, user_id, date, steps) VALUES (7, 6, '2022-01-01', 4000);",SELECT MIN(steps) as min_steps_per_day FROM steps JOIN users ON steps.user_id = users.id WHERE country = 'Japan';,"-- There's no user country information in the provided schema.  
-- Returning the minimum steps per day across all users instead.
SELECT MIN(steps) FROM steps GROUP BY date;",False,False
List all animals added in the last week,"CREATE TABLE animal_population (animal_id INT, animal_name VARCHAR(50), program VARCHAR(50), added_date DATE); INSERT INTO animal_population (animal_id, animal_name, program, added_date) VALUES (1, 'Grizzly Bear', 'habitat_preservation', '2022-01-01'), (2, 'Gray Wolf', 'community_education', '2022-02-01'), (3, 'Bald Eagle', 'habitat_preservation', '2022-03-01'), (4, 'Red Fox', 'community_education', '2022-04-01');","SELECT animal_name, program, added_date FROM animal_population WHERE added_date >= DATEADD(WEEK, -1, GETDATE());","SELECT * FROM animal_population WHERE added_date >= date('now', '-7 days');",False,False
List all unique 'Company_Names' in the 'Collective_Bargaining' table which have a 'Union_Agreement_Status' of 'Active'.,"CREATE TABLE Collective_Bargaining (id INT, company_name VARCHAR(50), union_agreement_status VARCHAR(20)); INSERT INTO Collective_Bargaining (id, company_name, union_agreement_status) VALUES (1, 'ABC Corp', 'Active'), (2, 'XYZ Inc', 'Inactive'), (3, 'DEF Industries', 'Active');",SELECT DISTINCT company_name FROM Collective_Bargaining WHERE union_agreement_status = 'Active';,SELECT DISTINCT company_name FROM Collective_Bargaining WHERE union_agreement_status = 'Active';,True,True
What is the average acidity level in the ocean?,"CREATE TABLE ocean_acidification (location TEXT, acidity FLOAT); INSERT INTO ocean_acidification (location, acidity) VALUES ('Caribbean Sea', 8.2), ('Pacific Ocean', 8.1), ('Atlantic Ocean', 8.0);",SELECT AVG(acidity) FROM ocean_acidification;,SELECT AVG(acidity) FROM ocean_acidification;,True,True
Who are the researchers that have conducted climate research in the Antarctic region?,"CREATE TABLE ClimateResearch (id INT PRIMARY KEY, researcher_id INT, location VARCHAR(100), start_date DATE, end_date DATE); INSERT INTO ClimateResearch (id, researcher_id, location, start_date, end_date) VALUES (1, 2, 'Antarctic', '2022-01-01', '2022-02-28');",SELECT r.name FROM Researchers r JOIN ClimateResearch cr ON r.id = cr.researcher_id WHERE cr.location = 'Antarctic';,SELECT DISTINCT researcher_id FROM ClimateResearch WHERE location = 'Antarctic';,False,False
What is the total amount of research grants awarded to each faculty member in the past 5 years?,"CREATE TABLE faculty (faculty_id INT, name TEXT, gender TEXT, department TEXT); CREATE TABLE research_grants (grant_id INT, faculty_id INT, amount DECIMAL(10,2), date DATE);","SELECT f.name, SUM(rg.amount) FROM research_grants rg INNER JOIN faculty f ON rg.faculty_id = f.faculty_id WHERE rg.date >= DATE_SUB(CURRENT_DATE, INTERVAL 5 YEAR) GROUP BY f.name;","SELECT f.name, SUM(rg.amount) AS total_amount
FROM faculty f
JOIN research_grants rg ON f.faculty_id = rg.faculty_id
WHERE rg.date >= DATE('now', '-5 years')
GROUP BY f.faculty_id, f.name;",False,False
What is the count of IoT sensors in Colombia that are not sending data in the last week?,"CREATE TABLE iot_sensors (id INT, sensor_type VARCHAR(50), location VARCHAR(50), last_data_received DATE); INSERT INTO iot_sensors (id, sensor_type, location, last_data_received) VALUES (1, 'Temperature', 'Colombia', '2022-04-15'), (2, 'Humidity', 'Colombia', '2022-04-18'), (3, 'Soil Moisture', 'Colombia', '2022-04-19'), (4, 'Temperature', 'Colombia', '2022-04-20'), (5, 'Humidity', 'Colombia', '2022-04-21');","SELECT COUNT(*) FROM iot_sensors WHERE last_data_received <= DATE_SUB(CURDATE(), INTERVAL 7 DAY);","SELECT COUNT(*) FROM iot_sensors WHERE location = 'Colombia' AND last_data_received < DATE('now', '-7 days');",False,False
What is the total number of high severity vulnerabilities reported by external sources in the last month?,"CREATE TABLE vulnerabilities (id INT, severity TEXT, source TEXT, reported_date DATE); INSERT INTO vulnerabilities (id, severity, source, reported_date) VALUES (1, 'high', 'external', '2021-10-05'); INSERT INTO vulnerabilities (id, severity, source, reported_date) VALUES (2, 'medium', 'internal', '2021-10-07'); INSERT INTO vulnerabilities (id, severity, source, reported_date) VALUES (3, 'high', 'external', '2021-11-02');","SELECT COUNT(*) FROM vulnerabilities WHERE severity = 'high' AND reported_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND source = 'external';","SELECT COUNT(*) FROM vulnerabilities WHERE severity = 'high' AND source = 'external' AND reported_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH);",False,False
What is the total landfill capacity in cubic meters for each country in North America in 2021?,"CREATE TABLE landfill_capacity_north_america (country VARCHAR(50), year INT, capacity FLOAT); INSERT INTO landfill_capacity_north_america (country, year, capacity) VALUES ('Canada', 2021, 12000000.0), ('Mexico', 2021, 15000000.0), ('USA', 2021, 20000000.0);","SELECT country, SUM(capacity) FROM landfill_capacity_north_america WHERE year = 2021 GROUP BY country;","SELECT country, capacity FROM landfill_capacity_north_america WHERE year = 2021;",False,False
What is the total number of mobile customers and broadband customers in each country?,"CREATE TABLE mobile_customers_global (customer_id INT, country VARCHAR(50)); CREATE TABLE broadband_customers_global (customer_id INT, country VARCHAR(50)); INSERT INTO mobile_customers_global (customer_id, country) VALUES (16, 'US'), (17, 'CA'), (18, 'MX'), (19, 'CA'), (20, 'US'); INSERT INTO broadband_customers_global (customer_id, country) VALUES (21, 'US'), (22, 'CA'), (23, 'MX'), (24, 'CA'), (25, 'US');","SELECT country, COUNT(DISTINCT mobile_customers_global.customer_id) + COUNT(DISTINCT broadband_customers_global.customer_id) FROM mobile_customers_global FULL OUTER JOIN broadband_customers_global ON mobile_customers_global.country = broadband_customers_global.country GROUP BY country;","SELECT country, COUNT(*) AS total_mobile_customers FROM mobile_customers_global GROUP BY country UNION ALL SELECT country, COUNT(*) AS total_broadband_customers FROM broadband_customers_global GROUP BY country;",False,False
What is the total duration of workouts for member 2 in 2020?,"CREATE TABLE Workouts (WorkoutID INT, MemberID INT, WorkoutDate DATE, Duration INT); INSERT INTO Workouts (WorkoutID, MemberID, WorkoutDate, Duration) VALUES (1, 2, '2020-01-01', 60), (2, 2, '2020-02-01', 75);",SELECT SUM(Duration) FROM Workouts WHERE MemberID = 2 AND YEAR(WorkoutDate) = 2020;,"SELECT SUM(Duration) FROM Workouts WHERE MemberID = 2 AND strftime('%Y', WorkoutDate) = '2020';",False,False
List the space missions with the longest durations as of 2022.,"CREATE TABLE SpaceMissions (id INT, mission_name VARCHAR(255), country VARCHAR(255), start_date DATE, end_date DATE); INSERT INTO SpaceMissions (id, mission_name, country, start_date, end_date) VALUES (1, 'International Space Station', 'United States', '1998-11-02', '2022-02-28'); INSERT INTO SpaceMissions (id, mission_name, country, start_date, end_date) VALUES (2, 'Apollo 17', 'United States', '1972-12-07', '1972-12-19');","SELECT mission_name, TIMESTAMPDIFF(YEAR, start_date, COALESCE(end_date, CURDATE())) as 'Mission Duration (Years)' FROM SpaceMissions WHERE end_date IS NULL OR end_date >= '2022-01-01' ORDER BY 'Mission Duration (Years)' DESC","SELECT mission_name, JULIANDAY(end_date) - JULIANDAY(start_date) AS mission_duration FROM SpaceMissions ORDER BY mission_duration DESC;",False,False
How many times has each type of agricultural automation technology been updated in the database?,"CREATE TABLE automation_tech (tech_id INT, tech_type VARCHAR(255), last_update_date DATE); INSERT INTO automation_tech (tech_id, tech_type, last_update_date) VALUES (1, 'autonomous tractors', '2022-01-01'), (2, 'drone spraying', '2021-12-15'), (3, 'precision seeding', '2022-03-03'), (4, 'autonomous tractors', '2022-04-01');","SELECT automation_tech.tech_type, COUNT(automation_tech.tech_id) FROM automation_tech GROUP BY automation_tech.tech_type;","SELECT tech_type, COUNT(*) AS update_count FROM automation_tech GROUP BY tech_type;",False,False
What is the daily ridership of public transportation in Toronto by mode?,"CREATE TABLE TOPublicTransportation (id INT, date DATE, mode VARCHAR(20), ridership INT);","SELECT mode, SUM(ridership) FROM TOPublicTransportation WHERE date = '2022-03-01' GROUP BY mode;","SELECT date, mode, SUM(ridership) FROM TOPublicTransportation GROUP BY date, mode;",False,False
Delete the 'Ford Fusion' from the vehicle_safety table if its safety rating is less than 5.,"CREATE TABLE vehicle_safety (id INT PRIMARY KEY, make VARCHAR(50), model VARCHAR(50), safety_rating FLOAT); INSERT INTO vehicle_safety (id, make, model, safety_rating) VALUES (1, 'Audi', 'A4', 5.2), (2, 'BMW', '3 Series', 5.0), (3, 'Ford', 'Fusion', 4.7), (4, 'Volkswagen', 'Golf', 4.9);",DELETE FROM vehicle_safety WHERE make = 'Ford' AND model = 'Fusion' AND safety_rating < 5;,DELETE FROM vehicle_safety WHERE make = 'Ford' AND model = 'Fusion' AND safety_rating < 5;,True,True
How many workouts were completed by members in the last 7 days?,"CREATE TABLE member_workouts (workout_id INT, member_id INT, workout_date DATE); INSERT INTO member_workouts (workout_id, member_id, workout_date) VALUES (1, 1, '2022-01-01'), (2, 2, '2022-01-02'), (3, 3, '2022-01-03'), (4, 4, '2022-01-04'), (5, 5, '2022-01-05'); CREATE TABLE member_demographics (member_id INT, last_workout_date DATE); INSERT INTO member_demographics (member_id, last_workout_date) VALUES (1, '2022-01-01'), (2, '2022-01-06'), (3, '2022-01-05'), (4, '2022-01-02'), (5, '2022-01-03');",SELECT COUNT(*) FROM member_workouts WHERE workout_date >= CURDATE() - INTERVAL 7 DAY;,"SELECT COUNT(*) FROM member_workouts WHERE workout_date >= DATE('now', '-7 days');",False,False
Show landfill capacity for India for the year 2022,"CREATE TABLE landfill_capacity ( country VARCHAR(50), year INT, capacity INT);",SELECT capacity FROM landfill_capacity WHERE country = 'India' AND year = 2022;,SELECT capacity FROM landfill_capacity WHERE country = 'India' AND year = 2022;,True,True
What is the name and state of the city with the highest population?,"CREATE TABLE City (id INT, name VARCHAR(50), state VARCHAR(50), population INT); INSERT INTO City (id, name, state, population) VALUES (1, 'Los Angeles', 'CA', 4000000); INSERT INTO City (id, name, state, population) VALUES (2, 'New York', 'NY', 8500000); INSERT INTO City (id, name, state, population) VALUES (3, 'Chicago', 'IL', 2700000); INSERT INTO City (id, name, state, population) VALUES (4, 'Houston', 'TX', 2300000); INSERT INTO City (id, name, state, population) VALUES (5, 'Phoenix', 'AZ', 1700000);","SELECT City.name, City.state FROM City ORDER BY City.population DESC LIMIT 1;","SELECT name, state FROM City ORDER BY population DESC LIMIT 1;",False,False
How many carbon offset initiatives are there in total in the 'carbon_offsets' table?,"CREATE TABLE if not exists carbon_offsets (initiative_id INT, initiative_name VARCHAR(255), location VARCHAR(255), offset_amount INT);",SELECT COUNT(*) FROM carbon_offsets WHERE offset_amount IS NOT NULL;,SELECT COUNT(*) FROM carbon_offsets;,False,False
"Find the title and genre of the top 3 movies with the highest ratings from studios based in Italy, ordered by ratings in descending order.","CREATE TABLE movies (title VARCHAR(255), genre VARCHAR(255), studio VARCHAR(255), rating FLOAT); INSERT INTO movies (title, genre, studio, rating) VALUES ('Movie19', 'Action', 'Italy Studio1', 8.5), ('Movie20', 'Drama', 'Italy Studio2', 9.0);","SELECT title, genre FROM (SELECT title, genre, studio, rating, ROW_NUMBER() OVER (PARTITION BY studio ORDER BY rating DESC) as rank FROM movies WHERE studio LIKE '%Italy%') subquery WHERE rank <= 3 ORDER BY rating DESC;","SELECT title, genre FROM movies WHERE studio LIKE 'Italy%' ORDER BY rating DESC LIMIT 3;",False,False
Which renewable energy farms in the 'East' region have an efficiency greater than 30%?,"CREATE TABLE wind_farms (id INT, name VARCHAR(50), region VARCHAR(50), capacity FLOAT, efficiency FLOAT); INSERT INTO wind_farms (id, name, region, capacity, efficiency) VALUES (1, 'Windfarm A', 'East', 120.3, 0.32); CREATE TABLE solar_farms (id INT, name VARCHAR(50), region VARCHAR(50), capacity FLOAT, efficiency FLOAT); INSERT INTO solar_farms (id, name, region, capacity, efficiency) VALUES (1, 'Solarfarm A', 'East', 180.5, 0.35);","SELECT name, efficiency FROM wind_farms WHERE region = 'East' UNION SELECT name, efficiency FROM solar_farms WHERE region = 'East' HAVING efficiency > 0.3;",SELECT name FROM wind_farms WHERE region = 'East' AND efficiency > 0.3 UNION ALL SELECT name FROM solar_farms WHERE region = 'East' AND efficiency > 0.3,False,False
What is the maximum number of articles published in a day for 'politics' category?,"CREATE TABLE daily_articles_by_category (id INT, publication_date DATE, category VARCHAR(30), articles INT); INSERT INTO daily_articles_by_category (id, publication_date, category, articles) VALUES (1, '2022-01-01', 'politics', 2), (2, '2022-01-02', 'politics', 3), (3, '2022-01-03', 'politics', 4), (4, '2022-01-04', 'politics', 5);",SELECT MAX(articles) FROM daily_articles_by_category WHERE category = 'politics';,SELECT MAX(articles) FROM daily_articles_by_category WHERE category = 'politics';,True,True
What is the total population of cities with a population density greater than 5000?,"CREATE TABLE City (id INT, name VARCHAR(50), population INT, population_density INT); INSERT INTO City (id, name, population, population_density) VALUES (1, 'CityA', 50000, 6000); INSERT INTO City (id, name, population, population_density) VALUES (2, 'CityB', 75000, 4000); INSERT INTO City (id, name, population, population_density) VALUES (3, 'CityC', 65000, 5500);",SELECT SUM(population) FROM City WHERE population_density > 5000;,SELECT SUM(population) FROM City WHERE population_density > 5000;,True,True
Who are the donors who have not donated in the last year?,"CREATE TABLE Donors (DonorID INT, DonorName TEXT, LastDonationDate DATE); INSERT INTO Donors (DonorID, DonorName, LastDonationDate) VALUES (1, 'John Doe', '2021-01-01'), (2, 'Jane Smith', '2019-06-15');","SELECT DonorID, DonorName FROM Donors WHERE LastDonationDate < DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR);","SELECT DonorName FROM Donors WHERE LastDonationDate < DATE('now', '-1 year');",False,False
Delete all records of nail polish sales in Canada before 2020.,"CREATE TABLE NailPolishSales (sale_id INT, product_name VARCHAR(100), category VARCHAR(50), price DECIMAL(10,2), quantity INT, sale_date DATE, country VARCHAR(50));",DELETE FROM NailPolishSales WHERE category = 'Nail Polish' AND country = 'Canada' AND sale_date < '2020-01-01';,DELETE FROM NailPolishSales WHERE country = 'Canada' AND sale_date < '2020-01-01';,False,False
What is the average number of artworks in the collections from Oceania?,"CREATE TABLE collections (id INT, name VARCHAR(50), artworks INT); INSERT INTO collections (id, name, artworks) VALUES (1, 'Oceania Collection 1', 50), (2, 'Oceania Collection 2', 60), (3, 'European Collection', 70);",SELECT AVG(artworks) FROM collections WHERE name LIKE '%Oceania%';,SELECT AVG(artworks) FROM collections WHERE name LIKE '%Oceania%';,True,True
Count the number of sessions longer than 60 minutes for users in the Western US?,"CREATE TABLE sessions (id INT, user_id INT, duration INT, region VARCHAR(10)); INSERT INTO sessions (id, user_id, duration, region) VALUES (1, 1, 45, 'West'), (2, 2, 75, 'East'), (3, 3, 62, 'Midwest'), (4, 1, 70, 'West'), (5, 2, 80, 'East');",SELECT COUNT(*) FROM sessions WHERE duration > 60 AND region = 'West';,SELECT COUNT(*) FROM sessions WHERE duration > 60 AND region = 'West';,True,True
Delete the painting 'Guernica' from the 'Paintings' table.,"CREATE TABLE Paintings (PaintingID INT, Title VARCHAR(50), ArtistID INT, YearCreated INT); INSERT INTO Paintings (PaintingID, Title, ArtistID, YearCreated) VALUES (1, 'Starry Night', 1, 1889); INSERT INTO Paintings (PaintingID, Title, ArtistID, YearCreated) VALUES (2, 'Guernica', 2, 1937);",DELETE FROM Paintings WHERE Title = 'Guernica';,DELETE FROM Paintings WHERE Title = 'Guernica';,True,True
Get the minimum surface salinity in the Arctic Ocean,"CREATE TABLE ocean_salinity (id INT, location TEXT, salinity REAL);",SELECT MIN(salinity) FROM ocean_salinity WHERE location = 'Arctic Ocean';,SELECT MIN(salinity) FROM ocean_salinity WHERE location = 'Arctic Ocean';,True,True
Number of volunteers in each program,"CREATE TABLE Volunteers (VolunteerID INT, VolunteerAge INT, Program VARCHAR(50));","SELECT Program, COUNT(*) as NumberOfVolunteers FROM Volunteers GROUP BY Program;","SELECT Program, COUNT(*) AS VolunteerCount FROM Volunteers GROUP BY Program;",False,False
"Identify the top 2 countries with the highest renewable energy production per capita, excluding countries with a population less than 10 million.","CREATE TABLE energy_production (country VARCHAR(20), population INT, renewable_energy_production INT); INSERT INTO energy_production (country, population, renewable_energy_production) VALUES ('Canada', 38000000, 616000), ('Germany', 83000000, 355000), ('France', 67000000, 229000), ('Spain', 47000, 228000), ('Brazil', 212000000, 465000), ('Australia', 25000000, 183000);","SELECT country, renewable_energy_production/population AS production_per_capita FROM energy_production WHERE population >= 10000000 GROUP BY country ORDER BY production_per_capita DESC LIMIT 2;",SELECT country FROM energy_production WHERE population >= 10000000 ORDER BY CAST(renewable_energy_production AS REAL) / population DESC LIMIT 2;,False,False
Who are the vendors in Illinois selling the most expensive product?,"CREATE TABLE vendors (vendor_id INT, vendor_name VARCHAR(50), state VARCHAR(50)); INSERT INTO vendors VALUES (1, 'VendorA', 'Illinois'); INSERT INTO vendors VALUES (2, 'VendorB', 'Texas'); CREATE TABLE products (product_id INT, product_name VARCHAR(50), vendor_id INT, price DECIMAL(5,2)); INSERT INTO products VALUES (1, 'Product1', 1, 150); INSERT INTO products VALUES (2, 'Product2', 1, 75); INSERT INTO products VALUES (3, 'Product3', 2, 100); INSERT INTO products VALUES (4, 'Product4', 1, 200);",SELECT vendors.vendor_name FROM vendors JOIN products ON vendors.vendor_id = products.vendor_id WHERE vendors.state = 'Illinois' AND products.price = (SELECT MAX(price) FROM products WHERE products.vendor_id = vendors.vendor_id);,"SELECT v.vendor_name
FROM vendors v
JOIN products p ON v.vendor_id = p.vendor_id
WHERE v.state = 'Illinois'
ORDER BY p.price DESC
LIMIT 1;",False,False
"Find the local economic impact of tourism in Tokyo, Japan in 2022.","CREATE TABLE local_impact_japan (year INT, location TEXT, economic_impact INT); INSERT INTO local_impact_japan (year, location, economic_impact) VALUES (2019, 'Tokyo', 15000), (2022, 'Tokyo', 12000);",SELECT economic_impact FROM local_impact_japan WHERE location = 'Tokyo' AND year = 2022;,SELECT economic_impact FROM local_impact_japan WHERE location = 'Tokyo' AND year = 2022,False,False
"Which menu items are served at both Location1 and Location2, but not at Location3?","CREATE TABLE menu_items(menu_item VARCHAR(255), location VARCHAR(255)); INSERT INTO menu_items(menu_item, location) VALUES ('Burger', 'Location1'), ('Pizza', 'Location2'), ('Pasta', 'Location1'), ('Salad', 'Location2'), ('Burger', 'Location3');",SELECT menu_item FROM menu_items WHERE location = 'Location1' INTERSECT SELECT menu_item FROM menu_items WHERE location = 'Location2' EXCEPT SELECT menu_item FROM menu_items WHERE location = 'Location3';,SELECT menu_item FROM menu_items WHERE location = 'Location1' INTERSECT SELECT menu_item FROM menu_items WHERE location = 'Location2' EXCEPT SELECT menu_item FROM menu_items WHERE location = 'Location3';,True,True
"What are the unique combinations of security incident types and their corresponding statuses in the incident_responses table, excluding any records with 'In Progress' status?","CREATE TABLE incident_responses (incident VARCHAR(50), status VARCHAR(15)); INSERT INTO incident_responses (incident, status) VALUES ('Incident 1', 'Resolved'), ('Incident 2', 'In Progress'), ('Incident 3', 'Resolved'), ('Incident 4', 'In Progress'), ('Incident 5', 'Assessed');","SELECT incident, status FROM incident_responses WHERE status != 'In Progress' GROUP BY incident, status;","SELECT DISTINCT incident, status FROM incident_responses WHERE status != 'In Progress';",False,False
What is the number of transactions by day for the month of January 2022?,"CREATE TABLE transactions (transaction_id INT, transaction_date DATE);","SELECT DATE(transaction_date) as transaction_day, COUNT(transaction_id) as number_of_transactions FROM transactions WHERE transaction_date BETWEEN '2022-01-01' AND '2022-01-31' GROUP BY transaction_day;","SELECT COUNT(*) , transaction_date FROM transactions WHERE CAST(transaction_date AS DATE) BETWEEN '2022-01-01' AND '2022-01-31' GROUP BY transaction_date;",False,False
What is the average number of passengers per trip for the 'Red Line' route during non-peak hours?,"CREATE TABLE Routes (RouteID int, RouteName varchar(255), Region varchar(255)); INSERT INTO Routes (RouteID, RouteName, Region) VALUES (1, 'North', 'East'), (2, 'South', 'Central'), (3, 'West', 'West'), (4, 'Red Line', 'East'); CREATE TABLE Trips (TripID int, RouteID int, Passengers int, TripDateTime datetime); CREATE TABLE PeakHours (PeakHourID int, StartTime time, EndTime time); INSERT INTO PeakHours (PeakHourID, StartTime, EndTime) VALUES (1, '06:00', '09:00'), (2, '16:00', '19:00');",SELECT AVG(Passengers) FROM Routes JOIN Trips ON Routes.RouteID = Trips.RouteID JOIN PeakHours ON Trips.TripDateTime BETWEEN PeakHours.StartTime AND PeakHours.EndTime WHERE Routes.RouteName = 'Red Line' AND NOT (PeakHours.StartTime BETWEEN '06:00' AND '09:00' OR PeakHours.StartTime BETWEEN '16:00' AND '19:00');,"SELECT AVG(T.Passengers)
FROM Trips T
JOIN Routes R ON T.RouteID = R.RouteID
WHERE R.RouteName = 'Red Line'
AND NOT EXISTS (
    SELECT 1
    FROM PeakHours P
    WHERE TIME(T.TripDateTime) BETWEEN P.StartTime AND P.EndTime
);",False,False
"Delete records from the ""trucks"" table where the ""year"" is less than 2022","CREATE TABLE trucks (id INT PRIMARY KEY, make VARCHAR(50), model VARCHAR(50), year INT);",DELETE FROM trucks WHERE year < 2022;,DELETE FROM trucks WHERE year < 2022;,True,True
"Identify the top 3 most expensive dams built in 'Asia' and their construction dates, if available.","CREATE TABLE Dams (id INT, country VARCHAR(20), continent VARCHAR(20), year INT, cost FLOAT); INSERT INTO Dams (id, country, continent, year, cost) VALUES (1, 'China', 'Asia', 2008, 8000000); INSERT INTO Dams (id, country, continent, year, cost) VALUES (2, 'India', 'Asia', 2012, 7000000); INSERT INTO Dams (id, country, continent, year, cost) VALUES (3, 'China', 'Asia', 2015, 9000000);","SELECT country, year, cost FROM (SELECT country, year, cost, RANK() OVER (PARTITION BY continent ORDER BY cost DESC) as dam_rank FROM Dams WHERE continent = 'Asia') tmp WHERE dam_rank <= 3;","SELECT country, year, cost FROM Dams WHERE continent = 'Asia' ORDER BY cost DESC LIMIT 3;",False,False
Alter the 'policyholders' table to add a constraint that the 'age' column should be between 1 and 120,"CREATE TABLE if not exists policyholders (policyholder_id INT PRIMARY KEY, name VARCHAR(255), age INT, gender VARCHAR(10), policy_type VARCHAR(50), premium DECIMAL(10,2));",ALTER TABLE policyholders ADD CONSTRAINT age_range CHECK (age >= 1 AND age <= 120);,ALTER TABLE policyholders ADD CONSTRAINT age_check CHECK (age BETWEEN 1 AND 120);,False,False
What is the sum of revenues for each vendor in a specific region?,"CREATE TABLE sales (sale_id INT, vendor_id INT, revenue DECIMAL(5,2)); INSERT INTO sales (sale_id, vendor_id, revenue) VALUES (1, 1, 100.00), (2, 1, 200.00), (3, 2, 300.00), (4, 3, 400.00), (5, 3, 500.00), (6, 4, 600.00); CREATE TABLE vendors (vendor_id INT, region TEXT); INSERT INTO vendors (vendor_id, region) VALUES (1, 'North America'), (2, 'South America'), (3, 'Europe'), (4, 'Asia');","SELECT vendors.region, SUM(sales.revenue) FROM vendors INNER JOIN sales ON vendors.vendor_id = sales.vendor_id GROUP BY vendors.region;","SELECT v.region, SUM(s.revenue) AS total_revenue FROM sales s JOIN vendors v ON s.vendor_id = v.vendor_id GROUP BY v.region;",False,False
What is the total number of security incidents that have occurred in each region in the past year?,"CREATE TABLE incident_region(id INT, region VARCHAR(50), incidents INT, incident_date DATE);","SELECT region, SUM(incidents) as total_incidents FROM incident_region WHERE incident_date > DATE(NOW()) - INTERVAL 365 DATE GROUP BY region;","SELECT region, SUM(incidents) AS total_incidents FROM incident_region WHERE incident_date >= DATE('now', '-1 year') GROUP BY region;",False,False
"Which Shariah-compliant financing products were offered by banks in the Middle East with a total financing amount over $1,000,000 in 2021?","CREATE TABLE ShariahFinance (bank_name VARCHAR(50), product_type VARCHAR(50), amount DECIMAL(10,2), issue_date DATE);","SELECT product_type, SUM(amount) as total_financing FROM ShariahFinance WHERE bank_name LIKE '%Middle East%' AND YEAR(issue_date) = 2021 GROUP BY product_type HAVING SUM(amount) > 1000000;","SELECT product_type
FROM ShariahFinance
WHERE strftime('%Y', issue_date) = '2021' 
GROUP BY product_type
HAVING SUM(amount) > 1000000;",False,False
How many students have enrolled in lifelong learning programs in each country?,"CREATE TABLE students_enrollment (id INT, student_id INT, country VARCHAR(255), enrollment_date DATE); INSERT INTO students_enrollment (id, student_id, country, enrollment_date) VALUES (1, 1, 'USA', '2021-08-01'), (2, 2, 'Canada', '2021-07-15'), (3, 3, 'USA', '2020-10-01');","SELECT country, COUNT(DISTINCT student_id) FROM students_enrollment WHERE enrollment_date >= DATEADD(year, -1, GETDATE()) GROUP BY country;","SELECT country, COUNT(*) FROM students_enrollment WHERE id IN (SELECT id FROM students_enrollment WHERE program_id IN (SELECT program_id FROM programs WHERE program_type = 'Lifelong Learning')) GROUP BY country;",False,False
What is the maximum production capacity of any tank in the Eastern region?,"CREATE TABLE Production (tank VARCHAR(20), capacity INT, location VARCHAR(20)); INSERT INTO Production (tank, capacity, location) VALUES ('Tank3', 100000, 'Eastern'), ('Tank4', 150000, 'Western');",SELECT MAX(capacity) FROM Production WHERE location = 'Eastern';,SELECT MAX(capacity) FROM Production WHERE location = 'Eastern';,True,True
Which buses have not been serviced in the past month?,"CREATE TABLE Vehicles(type TEXT, last_service DATE);","SELECT type FROM Vehicles WHERE last_service < DATE_SUB(CURDATE(), INTERVAL 1 MONTH);","SELECT type FROM Vehicles WHERE last_service < DATE('now', '-1 month') AND type = 'bus';",False,False
What is the total CO2 emissions for each marine conservation project?,"CREATE TABLE conservation_projects (id INT, name VARCHAR(20), co2_emissions INT); INSERT INTO conservation_projects (id, name, co2_emissions) VALUES (1, 'Coral Reef Restoration', 250), (2, 'Mangrove Forest Protection', 180), (3, 'Seagrass Meadows Conservation', 120);","SELECT name, SUM(co2_emissions) FROM conservation_projects GROUP BY name;","SELECT name, co2_emissions FROM conservation_projects;",False,False
Identify the 5 earliest artworks (creation date) for each artist.,"CREATE TABLE Artists (id INT, name TEXT); CREATE TABLE Artworks (id INT, artist_id INT, name TEXT, creation_date DATE);","SELECT artist_id, name, creation_date FROM (SELECT artist_id, name, creation_date, ROW_NUMBER() OVER (PARTITION BY artist_id ORDER BY creation_date ASC) as rn FROM Artworks) t WHERE rn <= 5;","WITH RankedArtworks AS (
  SELECT
    a.name AS artist_name,
    aw.name AS artwork_name,
    aw.creation_date,
    ROW_NUMBER() OVER (PARTITION BY a.id ORDER BY aw.creation_date) AS rn
  FROM Artists AS a
  JOIN Artworks AS aw
    ON a.id = aw.artist_id
)
SELECT
  artist_name,
  artwork_name,
  creation_date
FROM RankedArtworks
WHERE
  rn <= 5;",False,False
What is the total billing amount for family cases?,"CREATE TABLE family_cases (case_id INT, billing_amount DECIMAL(10,2)); INSERT INTO family_cases (case_id, billing_amount) VALUES (1, 1000.00), (2, 2500.50), (3, 500.00);",SELECT SUM(billing_amount) FROM family_cases WHERE case_type = 'family';,SELECT SUM(billing_amount) FROM family_cases;,False,False
"Insert a new record into the ""public_transportation_routes"" table for a route called ""Rapid 10""","CREATE TABLE public_transportation_routes (route_id INT, route_name VARCHAR(50), start_point VARCHAR(100), end_point VARCHAR(100));",INSERT INTO public_transportation_routes (route_name) VALUES ('Rapid 10');,INSERT INTO public_transportation_routes (route_name) VALUES ('Rapid 10');,True,True
What is the total quantity of each fabric type used in the production of sustainable clothing items in 2021?,"CREATE TABLE FabricInventory (InventoryID INT, ItemID INT, FabricType TEXT, Quantity INT); INSERT INTO FabricInventory (InventoryID, ItemID, FabricType, Quantity) VALUES (1, 1, 'Organic Cotton', 3), (2, 1, 'Hemp', 2), (3, 2, 'Recycled Polyester', 4), (4, 3, 'Organic Cotton', 5), (5, 4, 'Tencel', 6), (6, 5, 'Conventional Cotton', 7), (7, 6, 'Organic Cotton', 8), (8, 6, 'Hemp', 3), (9, 7, 'Recycled Polyester', 9); CREATE TABLE ClothingItems (ItemID INT, ItemName TEXT, ProductionDate DATE, Sustainable BOOLEAN); INSERT INTO ClothingItems (ItemID, ItemName, ProductionDate, Sustainable) VALUES (1, 'Organic Cotton Dress', '2021-01-01', true), (2, 'Recycled Polyester Skirt', '2021-02-01', true), (3, 'Organic Cotton Pants', '2021-03-01', true), (4, 'Tencel Jacket', '2021-04-01', true), (5, 'Conventional Cotton Shirt', '2021-05-01', false), (6, 'Sustainable Denim Jeans', '2021-06-01', true);","SELECT FabricType, SUM(Quantity) as TotalQuantity FROM FabricInventory JOIN ClothingItems ON FabricInventory.ItemID = ClothingItems.ItemID WHERE ProductionDate BETWEEN '2021-01-01' AND '2021-12-31' AND Sustainable = true GROUP BY FabricType;","SELECT FabricType, SUM(Quantity) AS TotalQuantity
FROM FabricInventory
JOIN ClothingItems ON FabricInventory.ItemID = ClothingItems.ItemID
WHERE ClothingItems.Sustainable = TRUE AND strftime('%Y', ClothingItems.ProductionDate) = '2021'
GROUP BY FabricType;",False,False
What is the maximum price of silk textiles sourced from China?,"CREATE TABLE textile_sourcing(id INT PRIMARY KEY, material VARCHAR(50), country VARCHAR(50), price DECIMAL(10,2)); INSERT INTO textile_sourcing(id, material, country, price) VALUES (1, 'cotton', 'Brazil', 3.50), (2, 'silk', 'China', 15.00), (3, 'wool', 'Australia', 7.00), (4, 'polyester', 'India', 2.00), (5, 'silk', 'China', 17.00);",SELECT MAX(price) FROM textile_sourcing WHERE material = 'silk' AND country = 'China';,SELECT MAX(price) FROM textile_sourcing WHERE material = 'silk' AND country = 'China';,True,True
Insert new companies founded by underrepresented groups.,"CREATE TABLE Companies (id INT, name TEXT, founder_group TEXT); INSERT INTO Companies (id, name, founder_group) VALUES (1, 'NativeRoot', 'Native American'), (2, 'Women in Power', 'Female'), (3, 'Green Horizons', 'Minority');","INSERT INTO Companies (id, name, founder_group) VALUES (4, 'QueerTech', 'LGBTQ+'), (5, 'Accessible Solutions', 'Disabled'), (6, 'International Innovations', 'Immigrant');","INSERT INTO Companies (name, founder_group) VALUES ('NewCompany1', 'LGBTQ+'), ('NewCompany2', 'Disabled');",False,False
Identify the menu items that were 86'ed (ran out) before 5pm on a specific day for the 'Gourmet Greens' restaurant.,"CREATE TABLE menu_items (id INT, restaurant_id INT, name VARCHAR(50), available INT, available_time TIME); INSERT INTO menu_items (id, restaurant_id, name, available, available_time) VALUES (1, 3, 'Kale Salad', 10, '12:00:00'), (2, 3, 'Beet Burger', 15, '12:00:00'), (3, 3, 'Carrot Fries', 20, '12:00:00'), (4, 3, 'Quinoa Bowl', 30, '12:00:00');",SELECT name FROM menu_items WHERE restaurant_id = 3 AND available_time < '17:00:00' GROUP BY name HAVING SUM(available) = 0;,SELECT name FROM menu_items WHERE available = 0 AND available_time < '17:00:00' AND restaurant_id = (SELECT restaurant_id FROM menu_items WHERE name = 'Kale Salad');,False,False
What was the total revenue for a specific shipment with ID 123?,"CREATE TABLE shipments (shipment_id INT, revenue DECIMAL(10,2)); INSERT INTO shipments (shipment_id, revenue) VALUES (123, 2000.50);",SELECT revenue FROM shipments WHERE shipment_id = 123;,SELECT revenue FROM shipments WHERE shipment_id = 123;,True,True
What was the average score of players from Japan in the 'global_tournament' table?,"CREATE TABLE global_tournament (player_id INT, player_name TEXT, score INT, country TEXT);",SELECT AVG(score) as avg_score FROM global_tournament WHERE country = 'Japan';,SELECT AVG(score) FROM global_tournament WHERE country = 'Japan';,False,False
Who are the top 3 countries with the most astronauts in space?,"CREATE TABLE Astronauts (name TEXT, nationality TEXT, missions INTEGER); INSERT INTO Astronauts (name, nationality, missions) VALUES ('Neil Armstrong', 'USA', 2), ('Buzz Aldrin', 'USA', 2), ('Peggy Whitson', 'USA', 3), ('Yuri Gagarin', 'Russia', 1), ('Valentina Tereshkova', 'Russia', 2), ('Takao Doi', 'Japan', 2), ('Soichi Noguchi', 'Japan', 3), ('Sunita Williams', 'India', 3);","SELECT nationality, COUNT(*) AS missions_count FROM Astronauts GROUP BY nationality ORDER BY missions_count DESC LIMIT 3;","SELECT nationality, COUNT(*) AS astronaut_count FROM Astronauts GROUP BY nationality ORDER BY astronaut_count DESC LIMIT 3;",False,False
What is the average water temperature for each fish species in February?,"CREATE TABLE SpeciesWaterTemp (SpeciesID int, Date date, WaterTemp float); INSERT INTO SpeciesWaterTemp (SpeciesID, Date, WaterTemp) VALUES (1, '2022-02-01', 12.8), (1, '2022-02-02', 13.1), (2, '2022-02-01', 14.3), (2, '2022-02-02', 14.7);","SELECT SpeciesName, AVG(WaterTemp) as AvgTemp FROM SpeciesWaterTemp INNER JOIN FishSpecies ON SpeciesWaterTemp.SpeciesID = FishSpecies.SpeciesID WHERE MONTH(Date) = 2 GROUP BY SpeciesName;","SELECT SpeciesID, AVG(WaterTemp) FROM SpeciesWaterTemp WHERE Date LIKE '2022-02%' GROUP BY SpeciesID;",False,False
What is the average sustainability rating of vegan skincare products?,"CREATE TABLE Skincare_Ingredients (ProductID int, ProductName varchar(100), IsVegan bit, SustainabilityRating int); INSERT INTO Skincare_Ingredients (ProductID, ProductName, IsVegan, SustainabilityRating) VALUES (1, 'Vegan Facial Cream', 1, 8); INSERT INTO Skincare_Ingredients (ProductID, ProductName, IsVegan, SustainabilityRating) VALUES (2, 'Natural Face Wash', 0, 6);",SELECT AVG(SustainabilityRating) FROM Skincare_Ingredients WHERE IsVegan = 1;,SELECT AVG(SustainabilityRating) FROM Skincare_Ingredients WHERE IsVegan = 1;,True,True
"How many art pieces were sold at the ""Metropolitan Art Gallery"" in 2021?","CREATE TABLE ArtSales (GalleryName TEXT, SaleDate DATE, NumPieces INTEGER); INSERT INTO ArtSales (GalleryName, SaleDate, NumPieces) VALUES ('Metropolitan Art Gallery', '2021-01-01', 12), ('Metropolitan Art Gallery', '2021-02-15', 15), ('Metropolitan Art Gallery', '2021-04-20', 18);",SELECT SUM(NumPieces) FROM ArtSales WHERE GalleryName = 'Metropolitan Art Gallery' AND YEAR(SaleDate) = 2021;,SELECT SUM(NumPieces) FROM ArtSales WHERE GalleryName = 'Metropolitan Art Gallery' AND SaleDate BETWEEN '2021-01-01' AND '2021-12-31',False,False
"What is the total number of public transportation projects in the ""projects"" table for projects with a budget less than $10 million?","CREATE TABLE projects (project_id INT, project_name VARCHAR(50), budget DECIMAL(10, 2), area VARCHAR(50)); INSERT INTO projects (project_id, project_name, budget, area) VALUES (1, 'ProjectT', 9000000.00, 'Urban'), (2, 'ProjectU', 7000000.00, 'Urban'), (3, 'ProjectV', 5000000.00, 'Urban');",SELECT COUNT(*) FROM projects WHERE budget < 10000000.00;,SELECT COUNT(*) FROM projects WHERE budget < 10000000;,False,False
What is the average number of citations for creative AI applications in the field of arts?,"CREATE TABLE Creative_AI_Applications (Application VARCHAR(50), Field VARCHAR(50), Citations INT); INSERT INTO Creative_AI_Applications (Application, Field, Citations) VALUES ('App1', 'Arts', 50), ('App2', 'Arts', 75), ('App3', 'Arts', 100), ('App4', 'Science', 120), ('App5', 'Science', 150);",SELECT AVG(Citations) as Average_Citations FROM Creative_AI_Applications WHERE Field = 'Arts';,SELECT AVG(Citations) FROM Creative_AI_Applications WHERE Field = 'Arts';,False,False
What is the average sea surface temperature in the Pacific Ocean per year?,"CREATE TABLE Ocean(id INT, region VARCHAR(20), temperature DECIMAL(5,2)); INSERT INTO Ocean(id, region, temperature) VALUES (1, 'Pacific', 20.5), (2, 'Atlantic', 18.3), (3, 'Indian', 23.2);","SELECT AVG(temperature) FROM (SELECT temperature FROM Ocean WHERE region = 'Pacific' GROUP BY temperature, YEAR(STR_TO_DATE(region, '%Y'))) AS PacificAverage;",SELECT AVG(temperature) FROM Ocean WHERE region  =  'Pacific',False,False
